{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.4", "generated_at": "2025-07-11T21:08:46.189531Z", "invocation_id": "d0c43237-0ac6-489d-94da-e7744a801c20", "invocation_started_at": "2025-07-11T21:08:39.819707Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T21:08:44.131428Z", "completed_at": "2025-07-11T21:08:44.303087Z"}, {"name": "execute", "started_at": "2025-07-11T21:08:44.306567Z", "completed_at": "2025-07-11T21:08:44.724641Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6070816516876221, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.ethiopian_medical_analytics.stg_telegram_messages", "compiled": true, "compiled_code": "\n\nWITH combined_messages AS (\n  SELECT id, text, date, views, _channel, _loaded_at\n  FROM \"telegram_analytics\".\"raw\".\"telegram_messages_chemed123\"\n  \n  UNION ALL\n  \n  SELECT id, text, date, views, _channel, _loaded_at\n  FROM \"telegram_analytics\".\"raw\".\"telegram_messages_lobelia4cosmetics\"\n  \n  UNION ALL\n  \n  SELECT id, text, date, views, _channel, _loaded_at\n  FROM \"telegram_analytics\".\"raw\".\"telegram_messages_tikvahpharma\"\n)\n\nSELECT\n  id::INTEGER AS message_id,\n  text AS message_text,\n  date::TIMESTAMP AS message_date,\n  _channel AS channel_name,\n  views::INTEGER AS view_count,\n  _loaded_at::TIMESTAMP AS loaded_at\nFROM combined_messages", "relation_name": "\"telegram_analytics\".\"star_staging\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T21:08:44.768801Z", "completed_at": "2025-07-11T21:08:44.820797Z"}, {"name": "execute", "started_at": "2025-07-11T21:08:44.824433Z", "completed_at": "2025-07-11T21:08:45.123528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3670485019683838, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.ethiopian_medical_analytics.dim_dates", "compiled": true, "compiled_code": "\n\nWITH date_spine AS (\n  SELECT DISTINCT\n    DATE_TRUNC('day', message_date) AS date_key\n  FROM \"telegram_analytics\".\"star_staging\".\"stg_telegram_messages\"\n)\n\nSELECT\n  date_key,\n  EXTRACT(YEAR FROM date_key) AS year,\n  EXTRACT(QUARTER FROM date_key) AS quarter,\n  EXTRACT(MONTH FROM date_key) AS month,\n  EXTRACT(DAY FROM date_key) AS day,\n  EXTRACT(DOW FROM date_key) AS day_of_week,\n  TO_CHAR(date_key, 'Day') AS day_name\nFROM date_spine", "relation_name": "\"telegram_analytics\".\"star_analytics\".\"dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T21:08:45.158363Z", "completed_at": "2025-07-11T21:08:45.208084Z"}, {"name": "execute", "started_at": "2025-07-11T21:08:45.211868Z", "completed_at": "2025-07-11T21:08:45.400127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.252941370010376, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.ethiopian_medical_analytics.stg_telegram_channels", "compiled": true, "compiled_code": "\n\nWITH channel_data AS (\n  SELECT DISTINCT\n    channel_name,  -- Changed from _channel to channel_name\n    MIN(loaded_at) AS first_scraped_at,\n    MAX(loaded_at) AS last_scraped_at\n  FROM \"telegram_analytics\".\"star_staging\".\"stg_telegram_messages\"\n  GROUP BY 1\n)\n\nSELECT\n  MD5(channel_name) AS channel_key,  -- Changed from _channel to channel_name\n  channel_name,\n  first_scraped_at,\n  last_scraped_at,\n  CURRENT_TIMESTAMP AS dbt_loaded_at\nFROM channel_data", "relation_name": "\"telegram_analytics\".\"star_staging\".\"stg_telegram_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T21:08:45.429125Z", "completed_at": "2025-07-11T21:08:45.464610Z"}, {"name": "execute", "started_at": "2025-07-11T21:08:45.469431Z", "completed_at": "2025-07-11T21:08:45.815894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3978090286254883, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.ethiopian_medical_analytics.dim_channels", "compiled": true, "compiled_code": "\n\nSELECT\n  channel_key,\n  channel_name,\n  first_scraped_at,\n  last_scraped_at,\n  CASE\n    WHEN channel_name ILIKE '%pharma%' THEN 'Pharmaceutical'\n    WHEN channel_name ILIKE '%cosmetic%' THEN 'Cosmetic'\n    ELSE 'Other'\n  END AS channel_category\nFROM \"telegram_analytics\".\"star_staging\".\"stg_telegram_channels\"", "relation_name": "\"telegram_analytics\".\"star_analytics\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T21:08:45.851299Z", "completed_at": "2025-07-11T21:08:45.887550Z"}, {"name": "execute", "started_at": "2025-07-11T21:08:45.891609Z", "completed_at": "2025-07-11T21:08:46.075812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23748540878295898, "adapter_response": {"_message": "SELECT 30", "code": "SELECT", "rows_affected": 30}, "message": "SELECT 30", "failures": null, "unique_id": "model.ethiopian_medical_analytics.fct_messages", "compiled": true, "compiled_code": "\n\nSELECT\n  m.message_id,\n  c.channel_key,\n  d.date_key,\n  m.message_text,\n  LENGTH(m.message_text) AS message_length,\n  m.view_count,\n  \n  -- Engagement metrics\n  CASE \n    WHEN m.view_count > 0 THEN m.view_count::FLOAT / NULLIF(m.view_count, 0)\n    ELSE NULL \n  END AS engagement_rate,\n  \n  -- Ethiopia mentions\n  CASE \n    WHEN m.message_text ILIKE '%ethiopia%' THEN TRUE\n    ELSE FALSE\n  END AS mentions_ethiopia,\n  \n  m.loaded_at\nFROM \"telegram_analytics\".\"star_staging\".\"stg_telegram_messages\" m\nLEFT JOIN \"telegram_analytics\".\"star_analytics\".\"dim_channels\" c ON m.channel_name = c.channel_name\nLEFT JOIN \"telegram_analytics\".\"star_analytics\".\"dim_dates\" d ON DATE_TRUNC('day', m.message_date) = d.date_key", "relation_name": "\"telegram_analytics\".\"star_analytics\".\"fct_messages\"", "batch_results": null}], "elapsed_time": 2.725088596343994, "args": {"which": "run", "require_all_warnings_handled_by_warn_error": false, "partial_parse_file_diff": true, "show_all_deprecations": false, "upload_to_artifacts_ingest_api": false, "state_modified_compare_vars": false, "invocation_command": "dbt run", "use_fast_test_edges": false, "printer_width": 80, "introspect": true, "populate_cache": true, "print": true, "send_anonymous_usage_stats": true, "vars": {}, "log_file_max_bytes": 10485760, "macro_debugging": false, "write_json": true, "partial_parse": true, "validate_macro_args": false, "show_resource_report": false, "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "log_level": "info", "log_format_file": "debug", "require_nested_cumulative_type_params": false, "select": [], "require_resource_names_without_spaces": true, "use_colors_file": true, "project_dir": "/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt", "indirect_selection": "eager", "source_freshness_run_project_hooks": true, "strict_mode": false, "exclude": [], "profiles_dir": "/home/hp/.dbt", "quiet": false, "version_check": true, "cache_selected_only": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "empty": false, "state_modified_compare_more_unrendered_values": false, "defer": false, "favor_state": false, "static_parser": true, "use_colors": true, "log_path": "/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs", "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_format": "default"}}