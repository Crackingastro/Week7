[0m22:35:19.920860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98f7fc0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9923c8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9905373b0>]}


============================== 22:35:19.926538 | a5c6fe66-df89-4101-9ffe-2810f7231392 ==============================
[0m22:35:19.926538 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:35:19.928353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:35:20.193596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c6fe66-df89-4101-9ffe-2810f7231392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99044ef30>]}
[0m22:35:20.254354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5c6fe66-df89-4101-9ffe-2810f7231392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98f9fb380>]}
[0m22:35:20.257609 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:35:20.311934 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:35:20.318414 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:35:20.319601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5c6fe66-df89-4101-9ffe-2810f7231392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98f7da390>]}
[0m22:35:21.156922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5c6fe66-df89-4101-9ffe-2810f7231392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc993a95cd0>]}
[0m22:35:21.222953 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m22:35:21.232182 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m22:35:21.280103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5c6fe66-df89-4101-9ffe-2810f7231392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98dbf2630>]}
[0m22:35:21.282075 [info ] [MainThread]: Found 5 models, 433 macros
[0m22:35:21.283548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c6fe66-df89-4101-9ffe-2810f7231392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98dfe1400>]}
[0m22:35:21.286721 [info ] [MainThread]: 
[0m22:35:21.288522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:21.289988 [info ] [MainThread]: 
[0m22:35:21.292253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:21.299450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_week7'
[0m22:35:21.359654 [debug] [ThreadPool]: Using postgres connection "list_week7"
[0m22:35:21.361541 [debug] [ThreadPool]: On list_week7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:35:21.363691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:31.376255 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "week7" to address: Temporary failure in name resolution

[0m22:35:41.388566 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:35:41.390957 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:35:41.393208 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:35:41.395043 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:35:41.397309 [debug] [ThreadPool]: On list_week7: No close available on handle
[0m22:35:41.401126 [debug] [ThreadPool]: Using postgres connection "list_week7"
[0m22:35:41.402875 [debug] [ThreadPool]: On list_week7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:35:41.404779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:54.350162 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "week7" to address: Temporary failure in name resolution

[0m22:36:04.362366 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:36:04.366092 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:36:04.368516 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:36:04.370601 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:36:04.372926 [debug] [ThreadPool]: On list_week7: No close available on handle
[0m22:36:04.375481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:36:04.377923 [debug] [MainThread]: Connection 'list_week7' was properly closed.
[0m22:36:04.380327 [info ] [MainThread]: 
[0m22:36:04.382340 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 43.09 seconds (43.09s).
[0m22:36:04.384500 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "week7" to address: Temporary failure in name resolution
  
[0m22:36:04.389121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 41.61513, "process_in_blocks": "101896", "process_kernel_time": 0.559603, "process_mem_max_rss": "127056", "process_out_blocks": "8", "process_user_time": 2.324506}
[0m22:36:04.391739 [debug] [MainThread]: Command `dbt run` failed at 22:36:04.391560 after 41.62 seconds
[0m22:36:04.393667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc99064ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98eb6cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98ebb09b0>]}
[0m22:36:04.395559 [debug] [MainThread]: Flushing usage events
[0m22:36:05.510193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:04.876905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e7213440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e659fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e73a3080>]}


============================== 22:41:04.881985 | fbba3a58-343c-41f2-af04-16691c12db1d ==============================
[0m22:41:04.881985 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:41:04.883313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/hp/.dbt', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:41:05.211915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbba3a58-343c-41f2-af04-16691c12db1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e6c4fda0>]}
[0m22:41:05.277555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbba3a58-343c-41f2-af04-16691c12db1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e6d66120>]}
[0m22:41:05.280493 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:41:05.340510 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:41:05.507143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:41:05.508210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:41:05.527462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbba3a58-343c-41f2-af04-16691c12db1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e57694f0>]}
[0m22:41:05.593996 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m22:41:05.601108 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m22:41:05.629166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbba3a58-343c-41f2-af04-16691c12db1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e4b48440>]}
[0m22:41:05.630717 [info ] [MainThread]: Found 5 models, 433 macros
[0m22:41:05.631789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbba3a58-343c-41f2-af04-16691c12db1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e7002f60>]}
[0m22:41:05.634233 [info ] [MainThread]: 
[0m22:41:05.635948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:41:05.637589 [info ] [MainThread]: 
[0m22:41:05.639468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:41:05.646060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_week7'
[0m22:41:05.695297 [debug] [ThreadPool]: Using postgres connection "list_week7"
[0m22:41:05.697176 [debug] [ThreadPool]: On list_week7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:41:05.699031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:15.710353 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "week7" to address: Temporary failure in name resolution

[0m22:41:25.723707 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:41:25.726332 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:41:25.728842 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:41:25.730908 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:41:25.733374 [debug] [ThreadPool]: On list_week7: No close available on handle
[0m22:41:25.737633 [debug] [ThreadPool]: Using postgres connection "list_week7"
[0m22:41:25.739541 [debug] [ThreadPool]: On list_week7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:41:25.741096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:38.663296 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "week7" to address: Temporary failure in name resolution

[0m22:41:48.676851 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:41:48.679490 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:41:48.682171 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:41:48.684216 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:41:48.686781 [debug] [ThreadPool]: On list_week7: No close available on handle
[0m22:41:48.690106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:48.691595 [debug] [MainThread]: Connection 'list_week7' was properly closed.
[0m22:41:48.693140 [info ] [MainThread]: 
[0m22:41:48.695201 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 43.05 seconds (43.05s).
[0m22:41:48.696896 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "week7" to address: Temporary failure in name resolution
  
[0m22:41:48.698777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 40.98227, "process_in_blocks": "64592", "process_kernel_time": 0.250161, "process_mem_max_rss": "121996", "process_out_blocks": "0", "process_user_time": 1.928324}
[0m22:41:48.700713 [debug] [MainThread]: Command `dbt run` failed at 22:41:48.700545 after 40.98 seconds
[0m22:41:48.702056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73eaa872f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e4b67da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73e4b45a90>]}
[0m22:41:48.703168 [debug] [MainThread]: Flushing usage events
[0m22:41:49.618193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:39.537323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf261e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7befe2e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf0342f30>]}


============================== 22:47:39.542506 | f792959f-52d4-45ac-b540-4a831ec233c8 ==============================
[0m22:47:39.542506 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:47:39.544103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/hp/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:47:39.888416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f792959f-52d4-45ac-b540-4a831ec233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf02fd940>]}
[0m22:47:39.952697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f792959f-52d4-45ac-b540-4a831ec233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf22f8bc0>]}
[0m22:47:39.956083 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:47:40.011854 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:47:40.199456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:40.200655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:40.221160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f792959f-52d4-45ac-b540-4a831ec233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7beeb822d0>]}
[0m22:47:40.288212 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m22:47:40.293831 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m22:47:40.322244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f792959f-52d4-45ac-b540-4a831ec233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bedf68a70>]}
[0m22:47:40.323521 [info ] [MainThread]: Found 5 models, 433 macros
[0m22:47:40.324828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f792959f-52d4-45ac-b540-4a831ec233c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bee7d9640>]}
[0m22:47:40.327186 [info ] [MainThread]: 
[0m22:47:40.328726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:47:40.329984 [info ] [MainThread]: 
[0m22:47:40.331169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:47:40.335896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_week7'
[0m22:47:40.370116 [debug] [ThreadPool]: Using postgres connection "list_week7"
[0m22:47:40.372258 [debug] [ThreadPool]: On list_week7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:47:40.374484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:50.386229 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "week7" to address: Temporary failure in name resolution

[0m22:48:00.395489 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:48:00.397773 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:48:00.399871 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:48:00.401537 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:48:00.403051 [debug] [ThreadPool]: On list_week7: No close available on handle
[0m22:48:00.406214 [debug] [ThreadPool]: Using postgres connection "list_week7"
[0m22:48:00.407444 [debug] [ThreadPool]: On list_week7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:48:00.408662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:48:10.416781 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "week7" to address: Temporary failure in name resolution

[0m22:48:24.529383 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_week7"} */

    select distinct nspname from pg_namespace
  
[0m22:48:24.532347 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:48:24.534797 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:48:24.536916 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:48:24.538911 [debug] [ThreadPool]: On list_week7: No close available on handle
[0m22:48:24.540737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:24.542486 [debug] [MainThread]: Connection 'list_week7' was properly closed.
[0m22:48:24.543762 [info ] [MainThread]: 
[0m22:48:24.545645 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 44.21 seconds (44.21s).
[0m22:48:24.547121 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "week7" to address: Temporary failure in name resolution
  
[0m22:48:24.588109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 41.022537, "process_in_blocks": "86152", "process_kernel_time": 0.200124, "process_mem_max_rss": "122576", "process_out_blocks": "0", "process_user_time": 1.874846}
[0m22:48:24.590064 [debug] [MainThread]: Command `dbt run` failed at 22:48:24.589942 after 41.02 seconds
[0m22:48:24.591852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bf03ab7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bedfe2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bedfe2de0>]}
[0m22:48:24.593897 [debug] [MainThread]: Flushing usage events
[0m22:48:27.674048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:20.220632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d56ece210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5473b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d54f9f380>]}


============================== 22:51:20.225349 | f8356d56-9ad8-4e16-a7f1-132a82879922 ==============================
[0m22:51:20.225349 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:51:20.226753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/hp/.dbt', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:51:20.550938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8356d56-9ad8-4e16-a7f1-132a82879922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d56df7770>]}
[0m22:51:20.621821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8356d56-9ad8-4e16-a7f1-132a82879922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d54777cb0>]}
[0m22:51:20.625424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:51:20.691756 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:51:20.746998 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:51:20.748659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8356d56-9ad8-4e16-a7f1-132a82879922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d54cb4500>]}
[0m22:51:21.640893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8356d56-9ad8-4e16-a7f1-132a82879922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5377bf80>]}
[0m22:51:21.703561 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m22:51:21.712406 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m22:51:21.750069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8356d56-9ad8-4e16-a7f1-132a82879922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d5270e4e0>]}
[0m22:51:21.751361 [info ] [MainThread]: Found 5 models, 433 macros
[0m22:51:21.752800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8356d56-9ad8-4e16-a7f1-132a82879922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d52bffd70>]}
[0m22:51:21.755470 [info ] [MainThread]: 
[0m22:51:21.756938 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:51:21.759261 [info ] [MainThread]: 
[0m22:51:21.761330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:51:21.767893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m22:51:21.807163 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m22:51:21.809546 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:51:21.811265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:21.847702 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"

[0m22:51:21.858719 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:51:21.860639 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:51:21.862375 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:51:21.864025 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:51:21.865442 [debug] [ThreadPool]: On list_telegram_analytics: No close available on handle
[0m22:51:21.869553 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m22:51:21.871668 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:51:21.873585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:51:21.885689 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"

[0m22:51:21.897257 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:51:21.899451 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:51:21.901769 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:51:21.903834 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:51:21.905361 [debug] [ThreadPool]: On list_telegram_analytics: No close available on handle
[0m22:51:21.907381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:21.908960 [debug] [MainThread]: Connection 'list_telegram_analytics' was properly closed.
[0m22:51:21.910711 [info ] [MainThread]: 
[0m22:51:21.912120 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m22:51:21.914107 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
  connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
  
[0m22:51:21.917774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.774782, "process_in_blocks": "70208", "process_kernel_time": 0.180723, "process_mem_max_rss": "127080", "process_out_blocks": "0", "process_user_time": 2.689591}
[0m22:51:21.919779 [debug] [MainThread]: Command `dbt run` failed at 22:51:21.919560 after 1.78 seconds
[0m22:51:21.921636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d54f9ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d52bfcbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d527371a0>]}
[0m22:51:21.923506 [debug] [MainThread]: Flushing usage events
[0m22:51:23.110163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:23.479271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7378e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7378f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7378e210>]}


============================== 22:53:23.484317 | b7713fde-9c44-4ead-8e8c-45c90ff2ad45 ==============================
[0m22:53:23.484317 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:53:23.486255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/hp/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:53:23.766141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7713fde-9c44-4ead-8e8c-45c90ff2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72eddd60>]}
[0m22:53:23.828331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7713fde-9c44-4ead-8e8c-45c90ff2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d731892e0>]}
[0m22:53:23.831607 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:53:23.886761 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:53:24.060044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:53:24.061226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:53:24.080520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7713fde-9c44-4ead-8e8c-45c90ff2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72fa83b0>]}
[0m22:53:24.141129 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m22:53:24.150297 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m22:53:24.188773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7713fde-9c44-4ead-8e8c-45c90ff2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7176a300>]}
[0m22:53:24.190401 [info ] [MainThread]: Found 5 models, 433 macros
[0m22:53:24.192268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7713fde-9c44-4ead-8e8c-45c90ff2ad45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71b1c9e0>]}
[0m22:53:24.195149 [info ] [MainThread]: 
[0m22:53:24.197082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:53:24.199167 [info ] [MainThread]: 
[0m22:53:24.201116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:53:24.207418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m22:53:24.244084 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m22:53:24.245699 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:53:24.247572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:24.272143 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"

[0m22:53:24.282735 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:53:24.284587 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:53:24.286641 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:53:24.288584 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:53:24.289743 [debug] [ThreadPool]: On list_telegram_analytics: No close available on handle
[0m22:53:24.292307 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m22:53:24.293626 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:53:24.294616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:24.303954 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"

[0m22:53:24.313343 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:53:24.314948 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:53:24.316489 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:53:24.317691 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:53:24.318703 [debug] [ThreadPool]: On list_telegram_analytics: No close available on handle
[0m22:53:24.320146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:24.320968 [debug] [MainThread]: Connection 'list_telegram_analytics' was properly closed.
[0m22:53:24.321772 [info ] [MainThread]: 
[0m22:53:24.322881 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m22:53:24.324281 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
  connection to server at "localhost" (127.0.0.1), port 5432 failed: FATAL:  password authentication failed for user "crackingastro"
  
[0m22:53:24.326972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9183123, "process_in_blocks": "90280", "process_kernel_time": 0.194472, "process_mem_max_rss": "125308", "process_out_blocks": "0", "process_user_time": 1.852607}
[0m22:53:24.328493 [debug] [MainThread]: Command `dbt run` failed at 22:53:24.328366 after 0.92 seconds
[0m22:53:24.329803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d7759f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d71783d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d72fa9550>]}
[0m22:53:24.330952 [debug] [MainThread]: Flushing usage events
[0m22:53:25.258457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:14.436729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d397367e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3992e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3a418a70>]}


============================== 22:57:14.442197 | 24ea6d28-cb81-431b-8385-f35f7cdd2338 ==============================
[0m22:57:14.442197 [info ] [MainThread]: Running with dbt=1.10.4
[0m22:57:14.443864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/hp/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:57:14.698911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3959cb90>]}
[0m22:57:14.758249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3d149610>]}
[0m22:57:14.762061 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:57:14.818673 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m22:57:14.868233 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:57:14.870512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d381b9bb0>]}
[0m22:57:15.674549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d38127620>]}
[0m22:57:15.738303 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m22:57:15.745535 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m22:57:15.772563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d37905340>]}
[0m22:57:15.773872 [info ] [MainThread]: Found 5 models, 433 macros
[0m22:57:15.775085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d396a9f70>]}
[0m22:57:15.777618 [info ] [MainThread]: 
[0m22:57:15.779095 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:57:15.780478 [info ] [MainThread]: 
[0m22:57:15.782160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:57:15.788018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m22:57:15.826311 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m22:57:15.827902 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:57:15.829304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:15.902944 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.073 seconds
[0m22:57:15.906238 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m22:57:15.910008 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m22:57:15.912470 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m22:57:15.920617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:15.929771 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m22:57:15.932892 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m22:57:15.935299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics, now create_telegram_analytics_star_analytics)
[0m22:57:15.937222 [debug] [ThreadPool]: Creating schema "database: "telegram_analytics"
schema: "star_analytics"
"
[0m22:57:15.942282 [debug] [ThreadPool]: Using postgres connection "create_telegram_analytics_star_analytics"
[0m22:57:15.943785 [debug] [ThreadPool]: On create_telegram_analytics_star_analytics: BEGIN
[0m22:57:15.945357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:15.954885 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m22:57:15.956645 [debug] [ThreadPool]: Using postgres connection "create_telegram_analytics_star_analytics"
[0m22:57:15.957887 [debug] [ThreadPool]: On create_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "create_telegram_analytics_star_analytics"} */
create schema if not exists "star_analytics"
[0m22:57:15.963879 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.005 seconds
[0m22:57:15.965829 [debug] [ThreadPool]: On create_telegram_analytics_star_analytics: COMMIT
[0m22:57:15.967060 [debug] [ThreadPool]: Using postgres connection "create_telegram_analytics_star_analytics"
[0m22:57:15.968271 [debug] [ThreadPool]: On create_telegram_analytics_star_analytics: COMMIT
[0m22:57:15.974018 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m22:57:15.975800 [debug] [ThreadPool]: On create_telegram_analytics_star_analytics: Close
[0m22:57:15.978398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_telegram_analytics_star_analytics, now create_telegram_analytics_star_staging)
[0m22:57:15.980140 [debug] [ThreadPool]: Creating schema "database: "telegram_analytics"
schema: "star_staging"
"
[0m22:57:15.983382 [debug] [ThreadPool]: Using postgres connection "create_telegram_analytics_star_staging"
[0m22:57:15.984983 [debug] [ThreadPool]: On create_telegram_analytics_star_staging: BEGIN
[0m22:57:15.986934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:15.996263 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m22:57:15.998308 [debug] [ThreadPool]: Using postgres connection "create_telegram_analytics_star_staging"
[0m22:57:15.999667 [debug] [ThreadPool]: On create_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "create_telegram_analytics_star_staging"} */
create schema if not exists "star_staging"
[0m22:57:16.002564 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m22:57:16.004730 [debug] [ThreadPool]: On create_telegram_analytics_star_staging: COMMIT
[0m22:57:16.006507 [debug] [ThreadPool]: Using postgres connection "create_telegram_analytics_star_staging"
[0m22:57:16.007956 [debug] [ThreadPool]: On create_telegram_analytics_star_staging: COMMIT
[0m22:57:16.011948 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m22:57:16.013243 [debug] [ThreadPool]: On create_telegram_analytics_star_staging: Close
[0m22:57:16.015987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_telegram_analytics_star_staging, now list_telegram_analytics_star_analytics)
[0m22:57:16.021709 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m22:57:16.023439 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m22:57:16.024624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:16.032988 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:57:16.034435 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m22:57:16.035631 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m22:57:16.044739 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:57:16.047336 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m22:57:16.049184 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m22:57:16.051684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now list_telegram_analytics_star_staging)
[0m22:57:16.054239 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m22:57:16.055799 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m22:57:16.057614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:16.065316 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m22:57:16.066997 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m22:57:16.068742 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m22:57:16.072364 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m22:57:16.074455 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m22:57:16.076573 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m22:57:16.081858 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:16.083591 [debug] [MainThread]: On master: BEGIN
[0m22:57:16.085642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:16.094509 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:57:16.096382 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:16.098489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:57:16.109088 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m22:57:16.111167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d358ac3e0>]}
[0m22:57:16.113037 [debug] [MainThread]: On master: ROLLBACK
[0m22:57:16.114912 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:16.116464 [debug] [MainThread]: On master: BEGIN
[0m22:57:16.118343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:57:16.119626 [debug] [MainThread]: On master: COMMIT
[0m22:57:16.121320 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:16.122987 [debug] [MainThread]: On master: COMMIT
[0m22:57:16.125054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:16.126371 [debug] [MainThread]: On master: Close
[0m22:57:16.132845 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m22:57:16.134118 [info ] [Thread-1 (]: 1 of 5 START sql view model star_staging.stg_telegram_messages ................. [RUN]
[0m22:57:16.135829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now model.ethiopian_medical_analytics.stg_telegram_messages)
[0m22:57:16.137077 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_messages
[0m22:57:16.143709 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m22:57:16.160577 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_messages
[0m22:57:16.188493 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m22:57:16.209187 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m22:57:16.210481 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: BEGIN
[0m22:57:16.211735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:16.219172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:57:16.220538 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m22:57:16.221657 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */

  create view "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    

WITH combined_messages AS (
  SELECT * FROM raw.telegram_messages_chemed
  UNION ALL
  SELECT * FROM raw.telegram_messages_lobelia4cosmetics
  -- Add more channels here
)

SELECT
  id::INTEGER AS message_id,
  text AS message_text,
  date::TIMESTAMP AS message_date,
  _channel AS channel_name,
  views::INTEGER AS view_count,
  _loaded_at::TIMESTAMP AS loaded_at
FROM combined_messages
  );
[0m22:57:16.224983 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.telegram_messages_chemed" does not exist
LINE 10:   SELECT * FROM raw.telegram_messages_chemed
                         ^

[0m22:57:16.226293 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: ROLLBACK
[0m22:57:16.228117 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: Close
[0m22:57:16.237390 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  relation "raw.telegram_messages_chemed" does not exist
  LINE 10:   SELECT * FROM raw.telegram_messages_chemed
                           ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_messages.sql
[0m22:57:16.241107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ea6d28-cb81-431b-8385-f35f7cdd2338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3a54c080>]}
[0m22:57:16.242543 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model star_staging.stg_telegram_messages ........ [[31mERROR[0m in 0.10s]
[0m22:57:16.243829 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m22:57:16.244954 [debug] [Thread-4 (]: Marking all children of 'model.ethiopian_medical_analytics.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  relation "raw.telegram_messages_chemed" does not exist
  LINE 10:   SELECT * FROM raw.telegram_messages_chemed
                           ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_messages.sql.
[0m22:57:16.247065 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_dates
[0m22:57:16.248489 [info ] [Thread-1 (]: 2 of 5 SKIP relation star_analytics.dim_dates .................................. [[33mSKIP[0m]
[0m22:57:16.249508 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_dates
[0m22:57:16.250614 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m22:57:16.251482 [info ] [Thread-1 (]: 3 of 5 SKIP relation star_staging.stg_telegram_channels ........................ [[33mSKIP[0m]
[0m22:57:16.252347 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m22:57:16.253604 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_channels
[0m22:57:16.254474 [info ] [Thread-1 (]: 4 of 5 SKIP relation star_analytics.dim_channels ............................... [[33mSKIP[0m]
[0m22:57:16.256224 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_channels
[0m22:57:16.258064 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.fct_messages
[0m22:57:16.259202 [info ] [Thread-1 (]: 5 of 5 SKIP relation star_analytics.fct_messages ............................... [[33mSKIP[0m]
[0m22:57:16.260612 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.fct_messages
[0m22:57:16.263187 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:16.264423 [debug] [MainThread]: On master: BEGIN
[0m22:57:16.265355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:57:16.273193 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m22:57:16.274765 [debug] [MainThread]: On master: COMMIT
[0m22:57:16.276924 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:16.278545 [debug] [MainThread]: On master: COMMIT
[0m22:57:16.280318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:16.281759 [debug] [MainThread]: On master: Close
[0m22:57:16.283037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:16.284388 [debug] [MainThread]: Connection 'model.ethiopian_medical_analytics.stg_telegram_messages' was properly closed.
[0m22:57:16.286263 [info ] [MainThread]: 
[0m22:57:16.288157 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m22:57:16.289792 [debug] [MainThread]: Command end result
[0m22:57:16.321120 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m22:57:16.326099 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m22:57:16.336298 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m22:57:16.337541 [info ] [MainThread]: 
[0m22:57:16.338662 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:57:16.340110 [info ] [MainThread]: 
[0m22:57:16.341467 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)[0m
[0m22:57:16.342947 [error] [MainThread]:   Database Error in model stg_telegram_messages (models/staging/stg_telegram_messages.sql)
  relation "raw.telegram_messages_chemed" does not exist
  LINE 10:   SELECT * FROM raw.telegram_messages_chemed
                           ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_messages.sql
[0m22:57:16.344217 [info ] [MainThread]: 
[0m22:57:16.345773 [info ] [MainThread]:   compiled code at target/compiled/ethiopian_medical_analytics/models/staging/stg_telegram_messages.sql
[0m22:57:16.347356 [info ] [MainThread]: 
[0m22:57:16.348905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=5
[0m22:57:16.352159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.993498, "process_in_blocks": "92096", "process_kernel_time": 0.251237, "process_mem_max_rss": "130924", "process_out_blocks": "0", "process_user_time": 2.512374}
[0m22:57:16.354179 [debug] [MainThread]: Command `dbt run` failed at 22:57:16.353915 after 2.00 seconds
[0m22:57:16.355978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d3a1b4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d38dcb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d37d147d0>]}
[0m22:57:16.357958 [debug] [MainThread]: Flushing usage events
[0m22:57:17.919329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:56.257465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357c9e80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357c653ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357c426150>]}


============================== 23:00:56.262828 | a8e5779b-8753-4497-8fb4-7676e7d4b333 ==============================
[0m23:00:56.262828 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:00:56.264189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:00:56.540186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8e5779b-8753-4497-8fb4-7676e7d4b333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357d85ee40>]}
[0m23:00:56.600739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8e5779b-8753-4497-8fb4-7676e7d4b333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357bbda660>]}
[0m23:00:56.604212 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:00:56.656102 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:00:56.841930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:00:56.843033 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_messages.sql
[0m23:00:57.022204 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ethiopian_medical_analytics.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages_lobelia4cosmetics' which was not found
[0m23:00:57.025911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8376794, "process_in_blocks": "82328", "process_kernel_time": 0.28051, "process_mem_max_rss": "120084", "process_out_blocks": "0", "process_user_time": 1.838902}
[0m23:00:57.027971 [debug] [MainThread]: Command `dbt run` failed at 23:00:57.027803 after 0.84 seconds
[0m23:00:57.029870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357bfee6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357bce2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3579fa4b90>]}
[0m23:00:57.031610 [debug] [MainThread]: Flushing usage events
[0m23:00:58.019009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:28.839912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabaedf7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabaedc1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabaedf60c0>]}


============================== 23:12:28.845109 | 61849d31-11c6-47fd-86fc-7aee9d0fb1cf ==============================
[0m23:12:28.845109 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:12:28.846494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'profiles_dir': '/home/hp/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:12:29.166164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61849d31-11c6-47fd-86fc-7aee9d0fb1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabaef8ffe0>]}
[0m23:12:29.238730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61849d31-11c6-47fd-86fc-7aee9d0fb1cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabae4dde20>]}
[0m23:12:29.241524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:12:29.306748 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:12:29.490112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:12:29.491831 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_messages.sql
[0m23:12:29.716352 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ethiopian_medical_analytics.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages_chemed' which was not found
[0m23:12:29.720041 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.95300627, "process_in_blocks": "83464", "process_kernel_time": 0.288272, "process_mem_max_rss": "120320", "process_out_blocks": "0", "process_user_time": 1.900463}
[0m23:12:29.721843 [debug] [MainThread]: Command `dbt compile` failed at 23:12:29.721704 after 0.95 seconds
[0m23:12:29.723359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabaed469c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabae4dce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabadd3fe30>]}
[0m23:12:29.725199 [debug] [MainThread]: Flushing usage events
[0m23:12:32.379207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:06.751733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe741966780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7429c67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe742022c60>]}


============================== 23:20:06.756776 | 233245bc-b251-488b-aa1c-0955bc405119 ==============================
[0m23:20:06.756776 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:20:06.757992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m23:20:07.038157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233245bc-b251-488b-aa1c-0955bc405119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe740dff0e0>]}
[0m23:20:07.098731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233245bc-b251-488b-aa1c-0955bc405119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe74164cfb0>]}
[0m23:20:07.102079 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:20:07.156066 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:20:07.312500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m23:20:07.313577 [debug] [MainThread]: Partial parsing: added file: ethiopian_medical_analytics://models/staging/sources.yml
[0m23:20:07.314449 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_messages.sql
[0m23:20:07.590124 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ethiopian_medical_analytics.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages_chemed' which was not found
[0m23:20:07.594455 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.9150484, "process_in_blocks": "76608", "process_kernel_time": 0.323322, "process_mem_max_rss": "123420", "process_out_blocks": "0", "process_user_time": 1.731337}
[0m23:20:07.597372 [debug] [MainThread]: Command `dbt compile` failed at 23:20:07.597117 after 0.92 seconds
[0m23:20:07.599666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe741ce9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7417a6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73f9d35c0>]}
[0m23:20:07.601655 [debug] [MainThread]: Flushing usage events
[0m23:20:08.647466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:31.078114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360ce970b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360a4240b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360aa802f0>]}


============================== 23:29:31.083320 | 325519ef-4b8f-4f34-ae07-ede2a980da2d ==============================
[0m23:29:31.083320 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:29:31.084561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/hp/.dbt', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:29:31.345857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '325519ef-4b8f-4f34-ae07-ede2a980da2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360c50b0b0>]}
[0m23:29:31.405437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '325519ef-4b8f-4f34-ae07-ede2a980da2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3609cefec0>]}
[0m23:29:31.408662 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:31.465469 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:29:31.672118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 5 files changed.
[0m23:29:31.673636 [debug] [MainThread]: Partial parsing: added file: ethiopian_medical_analytics://tests/validate_non_empty_messages.sql
[0m23:29:31.674636 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/marts/dim_dates.sql
[0m23:29:31.675617 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/marts/fct_messages.sql
[0m23:29:31.676527 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_channels.sql
[0m23:29:31.677390 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/marts/dim_channels.sql
[0m23:29:31.678237 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_messages.sql
[0m23:29:31.969047 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ethiopian_medical_analytics.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages_lobelia4cosmetics' which was not found
[0m23:29:31.973063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97506243, "process_in_blocks": "83992", "process_kernel_time": 0.294133, "process_mem_max_rss": "122988", "process_out_blocks": "0", "process_user_time": 1.785811}
[0m23:29:31.975390 [debug] [MainThread]: Command `dbt run` failed at 23:29:31.975268 after 0.98 seconds
[0m23:29:31.977526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360a7330b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360673bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f360673bf50>]}
[0m23:29:31.979603 [debug] [MainThread]: Flushing usage events
[0m23:29:33.627298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:40.030155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb537ac0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb537ac1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb537ac1b50>]}


============================== 23:30:40.036091 | 182fe871-35c9-4797-b0aa-18dd949d43b6 ==============================
[0m23:30:40.036091 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:30:40.038001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:30:40.315871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '182fe871-35c9-4797-b0aa-18dd949d43b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb535f6aff0>]}
[0m23:30:40.377859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '182fe871-35c9-4797-b0aa-18dd949d43b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb536a7eab0>]}
[0m23:30:40.381264 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:30:40.435070 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:30:40.607632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 5 files changed.
[0m23:30:40.609365 [debug] [MainThread]: Partial parsing: added file: ethiopian_medical_analytics://tests/validate_non_empty_messages.sql
[0m23:30:40.610620 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_messages.sql
[0m23:30:40.611669 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/marts/fct_messages.sql
[0m23:30:40.612640 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_channels.sql
[0m23:30:40.613694 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/marts/dim_channels.sql
[0m23:30:40.614763 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/marts/dim_dates.sql
[0m23:30:40.917210 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ethiopian_medical_analytics.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages_chemed123' which was not found
[0m23:30:40.921649 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.9694505, "process_in_blocks": "83864", "process_kernel_time": 0.226688, "process_mem_max_rss": "125152", "process_out_blocks": "0", "process_user_time": 1.916546}
[0m23:30:40.923985 [debug] [MainThread]: Command `dbt compile` failed at 23:30:40.923858 after 0.97 seconds
[0m23:30:40.926609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb537571df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb534b36540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb534ba3260>]}
[0m23:30:40.928294 [debug] [MainThread]: Flushing usage events
[0m23:30:41.845949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:12.697545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c853cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c8478140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c98d3530>]}


============================== 23:37:12.702833 | 944a4f64-8f30-4900-9c40-1cc88b1576cf ==============================
[0m23:37:12.702833 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:37:12.704264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'profiles_dir': '/home/hp/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:37:13.049397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '944a4f64-8f30-4900-9c40-1cc88b1576cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ca5636e0>]}
[0m23:37:13.114426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '944a4f64-8f30-4900-9c40-1cc88b1576cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c7c437a0>]}
[0m23:37:13.117230 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:37:13.180460 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:37:13.189329 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:37:13.190841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '944a4f64-8f30-4900-9c40-1cc88b1576cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c6f4dca0>]}
[0m23:37:14.060960 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ethiopian_medical_analytics.stg_telegram_messages' (models/staging/stg_telegram_messages.sql) depends on a source named 'raw.telegram_messages_lobelia4cosmetics' which was not found
[0m23:37:14.063437 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.4428946, "process_in_blocks": "83464", "process_kernel_time": 0.24142, "process_mem_max_rss": "119452", "process_out_blocks": "0", "process_user_time": 2.370314}
[0m23:37:14.064744 [debug] [MainThread]: Command `dbt compile` failed at 23:37:14.064598 after 1.44 seconds
[0m23:37:14.065702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c7d4ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c5f1e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61c5f93830>]}
[0m23:37:14.066600 [debug] [MainThread]: Flushing usage events
[0m23:37:15.055438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:45:43.420517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a76cc9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a760d71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a77d9cfe0>]}


============================== 23:45:43.426834 | 4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a ==============================
[0m23:45:43.426834 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:45:43.429055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:43.756165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a755fef60>]}
[0m23:45:43.822750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a77d9e690>]}
[0m23:45:43.826116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:45:43.889700 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:45:43.897508 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:45:43.899393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a751b1910>]}
[0m23:45:45.194676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7411f050>]}
[0m23:45:45.282033 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:45:45.291552 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:45:45.337126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a73deaf00>]}
[0m23:45:45.339443 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 433 macros
[0m23:45:45.341121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a7a0c6f90>]}
[0m23:45:45.345641 [info ] [MainThread]: 
[0m23:45:45.348356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:45:45.350586 [info ] [MainThread]: 
[0m23:45:45.352641 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:45:45.358357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics_star_analytics'
[0m23:45:45.433488 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:45:45.435042 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m23:45:45.436786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:45.469204 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m23:45:45.470896 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:45:45.472437 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m23:45:45.495510 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.021 seconds
[0m23:45:45.499679 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m23:45:45.502625 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m23:45:45.505646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now list_telegram_analytics_star_staging)
[0m23:45:45.510517 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:45:45.513285 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m23:45:45.515342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:45.529965 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m23:45:45.532608 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:45:45.534810 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m23:45:45.540549 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m23:45:45.544524 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m23:45:45.547311 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m23:45:45.557103 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:45.558902 [debug] [MainThread]: On master: BEGIN
[0m23:45:45.560133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:45:45.572794 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:45:45.574547 [debug] [MainThread]: Using postgres connection "master"
[0m23:45:45.576399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:45:45.586197 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m23:45:45.589393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b67334f-c1cb-4dbd-89cc-fdb2488f1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a75d81850>]}
[0m23:45:45.591311 [debug] [MainThread]: On master: ROLLBACK
[0m23:45:45.593989 [debug] [MainThread]: On master: Close
[0m23:45:45.599451 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:45:45.601508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now model.ethiopian_medical_analytics.stg_telegram_messages)
[0m23:45:45.603345 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:45:45.613870 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:45:45.636310 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:45:45.638274 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:45:45.640599 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_dates
[0m23:45:45.642307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_messages, now model.ethiopian_medical_analytics.dim_dates)
[0m23:45:45.644006 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_dates
[0m23:45:45.648544 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_dates"
[0m23:45:45.661826 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_dates
[0m23:45:45.663977 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_dates
[0m23:45:45.665450 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:45:45.666824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_dates, now model.ethiopian_medical_analytics.stg_telegram_channels)
[0m23:45:45.668241 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:45:45.672958 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:45:45.681489 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:45:45.683095 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:45:45.684321 [debug] [Thread-1 (]: Began running node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m23:45:45.685566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_channels, now test.ethiopian_medical_analytics.validate_non_empty_messages)
[0m23:45:45.686759 [debug] [Thread-1 (]: Began compiling node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m23:45:45.690247 [debug] [Thread-1 (]: Writing injected SQL for node "test.ethiopian_medical_analytics.validate_non_empty_messages"
[0m23:45:45.702400 [debug] [Thread-1 (]: Began executing node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m23:45:45.704552 [debug] [Thread-1 (]: Finished running node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m23:45:45.706074 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_channels
[0m23:45:45.707297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ethiopian_medical_analytics.validate_non_empty_messages, now model.ethiopian_medical_analytics.dim_channels)
[0m23:45:45.708291 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_channels
[0m23:45:45.711891 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_channels"
[0m23:45:45.721289 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_channels
[0m23:45:45.723261 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_channels
[0m23:45:45.725379 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.fct_messages
[0m23:45:45.727206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_channels, now model.ethiopian_medical_analytics.fct_messages)
[0m23:45:45.728963 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.fct_messages
[0m23:45:45.734452 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.fct_messages"
[0m23:45:45.743831 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.fct_messages
[0m23:45:45.745575 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.fct_messages
[0m23:45:45.748067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:45.749651 [debug] [MainThread]: Connection 'model.ethiopian_medical_analytics.fct_messages' was properly closed.
[0m23:45:45.752316 [debug] [MainThread]: Command end result
[0m23:45:45.780659 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:45:45.786850 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:45:45.797306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m23:45:45.800169 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.4742012, "process_in_blocks": "90728", "process_kernel_time": 0.31021, "process_mem_max_rss": "132076", "process_out_blocks": "0", "process_user_time": 3.283949}
[0m23:45:45.802006 [debug] [MainThread]: Command `dbt compile` succeeded at 23:45:45.801789 after 2.48 seconds
[0m23:45:45.803284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a75e42420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a749ad400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a765ecb60>]}
[0m23:45:45.804484 [debug] [MainThread]: Flushing usage events
[0m23:45:46.985258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:17.277122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764d7589b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764de0a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764d7588f0>]}


============================== 23:46:17.281501 | 8285386a-98db-4d78-b641-3260012c909f ==============================
[0m23:46:17.281501 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:46:17.282774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:46:17.464457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764f8a3290>]}
[0m23:46:17.529913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764fb04740>]}
[0m23:46:17.532058 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:46:17.580959 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:46:17.746426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:46:17.747525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:46:17.779936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764bfb1550>]}
[0m23:46:17.851888 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:46:17.892540 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:46:17.964853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764b74bb30>]}
[0m23:46:17.966699 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 433 macros
[0m23:46:17.968177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764bf714f0>]}
[0m23:46:17.970953 [info ] [MainThread]: 
[0m23:46:17.972857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:17.974479 [info ] [MainThread]: 
[0m23:46:17.977662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:46:17.983490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m23:46:18.022108 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m23:46:18.023504 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:46:18.024979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:18.038234 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m23:46:18.040358 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m23:46:18.045248 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m23:46:18.046373 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:46:18.047418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:18.057445 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m23:46:18.059482 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m23:46:18.061711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics, now list_telegram_analytics_star_staging)
[0m23:46:18.067608 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:46:18.068981 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m23:46:18.070113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:18.077512 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:46:18.079306 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:46:18.080482 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m23:46:18.084455 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:46:18.086522 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m23:46:18.088479 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m23:46:18.090549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now list_telegram_analytics_star_analytics)
[0m23:46:18.093318 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:46:18.094539 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m23:46:18.095925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:18.103232 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:46:18.104603 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:46:18.106034 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m23:46:18.109670 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:46:18.112005 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m23:46:18.113773 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m23:46:18.118442 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:18.119892 [debug] [MainThread]: On master: BEGIN
[0m23:46:18.121235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:18.129094 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:46:18.130286 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:18.131708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:46:18.136158 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:46:18.138355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764bf7aed0>]}
[0m23:46:18.140126 [debug] [MainThread]: On master: ROLLBACK
[0m23:46:18.141807 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:18.142838 [debug] [MainThread]: On master: BEGIN
[0m23:46:18.145091 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:46:18.146453 [debug] [MainThread]: On master: COMMIT
[0m23:46:18.147438 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:18.148529 [debug] [MainThread]: On master: COMMIT
[0m23:46:18.150053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:18.151370 [debug] [MainThread]: On master: Close
[0m23:46:18.154641 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:46:18.156005 [info ] [Thread-1 (]: 1 of 5 START sql view model star_staging.stg_telegram_messages ................. [RUN]
[0m23:46:18.157498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now model.ethiopian_medical_analytics.stg_telegram_messages)
[0m23:46:18.159078 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:46:18.166409 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:46:18.175835 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:46:18.206944 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:46:18.222855 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:46:18.224032 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: BEGIN
[0m23:46:18.225121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:18.231500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:18.233059 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:46:18.234074 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */

  create view "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    

WITH combined_messages AS (
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_chemed123"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_lobelia4cosmetics"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_tikvahpharma"
)

SELECT
  id::INTEGER AS message_id,
  text AS message_text,
  date::TIMESTAMP AS message_date,
  _channel AS channel_name,
  views::INTEGER AS view_count,
  _loaded_at::TIMESTAMP AS loaded_at
FROM combined_messages
  );
[0m23:46:18.280911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m23:46:18.286496 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:46:18.287760 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m23:46:18.289676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:18.302737 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:46:18.304440 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:46:18.305986 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:46:18.311404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:46:18.317339 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup"
[0m23:46:18.322530 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:46:18.323848 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
drop view if exists "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup" cascade
[0m23:46:18.326267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:46:18.329319 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: Close
[0m23:46:18.332683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764f8a24e0>]}
[0m23:46:18.334570 [info ] [Thread-1 (]: 1 of 5 OK created sql view model star_staging.stg_telegram_messages ............ [[32mCREATE VIEW[0m in 0.17s]
[0m23:46:18.336403 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:46:18.338431 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_dates
[0m23:46:18.339953 [info ] [Thread-1 (]: 2 of 5 START sql table model star_analytics.dim_dates .......................... [RUN]
[0m23:46:18.341731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_messages, now model.ethiopian_medical_analytics.dim_dates)
[0m23:46:18.342954 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_dates
[0m23:46:18.346192 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_dates"
[0m23:46:18.352664 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_dates
[0m23:46:18.372507 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.dim_dates"
[0m23:46:18.382635 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:46:18.383704 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: BEGIN
[0m23:46:18.384682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:18.391721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:46:18.393024 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:46:18.394025 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */

  
    

  create  table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH date_spine AS (
  SELECT DISTINCT
    DATE_TRUNC('day', message_date) AS date_key
  FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
)

SELECT
  date_key,
  EXTRACT(YEAR FROM date_key) AS year,
  EXTRACT(QUARTER FROM date_key) AS quarter,
  EXTRACT(MONTH FROM date_key) AS month,
  EXTRACT(DAY FROM date_key) AS day,
  EXTRACT(DOW FROM date_key) AS day_of_week,
  TO_CHAR(date_key, 'Day') AS day_name
FROM date_spine
  );
  
[0m23:46:18.413256 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.018 seconds
[0m23:46:18.419503 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:46:18.420961 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
alter table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m23:46:18.423103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:46:18.424946 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m23:46:18.426313 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:46:18.427261 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m23:46:18.431456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:46:18.433965 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."dim_dates__dbt_backup"
[0m23:46:18.436903 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:46:18.437852 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
drop table if exists "telegram_analytics"."star_analytics"."dim_dates__dbt_backup" cascade
[0m23:46:18.438921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:46:18.440413 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: Close
[0m23:46:18.441459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7648868980>]}
[0m23:46:18.442577 [info ] [Thread-1 (]: 2 of 5 OK created sql table model star_analytics.dim_dates ..................... [[32mSELECT 10[0m in 0.10s]
[0m23:46:18.443819 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_dates
[0m23:46:18.444641 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:46:18.445633 [info ] [Thread-1 (]: 3 of 5 START sql table model star_staging.stg_telegram_channels ................ [RUN]
[0m23:46:18.446687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_dates, now model.ethiopian_medical_analytics.stg_telegram_channels)
[0m23:46:18.447699 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:46:18.450453 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:46:18.457067 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:46:18.461293 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:46:18.468070 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:46:18.469127 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: BEGIN
[0m23:46:18.469968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:18.476135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:46:18.477693 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:46:18.478931 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */

  
    

  create  table "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  MD5(_channel) AS channel_key,
  _channel AS channel_name,
  MIN(_loaded_at) AS first_scraped_at,
  MAX(_loaded_at) AS last_scraped_at,
  CURRENT_TIMESTAMP AS dbt_loaded_at
FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
GROUP BY 1, 2
  );
  
[0m23:46:18.481699 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "_channel" does not exist
LINE 15:   MD5(_channel) AS channel_key,
               ^

[0m23:46:18.482703 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: ROLLBACK
[0m23:46:18.483888 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: Close
[0m23:46:18.491288 [debug] [Thread-1 (]: Database Error in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)
  column "_channel" does not exist
  LINE 15:   MD5(_channel) AS channel_key,
                 ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql
[0m23:46:18.492758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8285386a-98db-4d78-b641-3260012c909f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764b3fc3b0>]}
[0m23:46:18.494139 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model star_staging.stg_telegram_channels ....... [[31mERROR[0m in 0.05s]
[0m23:46:18.495376 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:46:18.496452 [debug] [Thread-4 (]: Marking all children of 'model.ethiopian_medical_analytics.stg_telegram_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)
  column "_channel" does not exist
  LINE 15:   MD5(_channel) AS channel_key,
                 ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql.
[0m23:46:18.498924 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_channels
[0m23:46:18.500082 [info ] [Thread-1 (]: 4 of 5 SKIP relation star_analytics.dim_channels ............................... [[33mSKIP[0m]
[0m23:46:18.501276 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_channels
[0m23:46:18.502914 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.fct_messages
[0m23:46:18.503875 [info ] [Thread-1 (]: 5 of 5 SKIP relation star_analytics.fct_messages ............................... [[33mSKIP[0m]
[0m23:46:18.504922 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.fct_messages
[0m23:46:18.507305 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:18.508626 [debug] [MainThread]: On master: BEGIN
[0m23:46:18.509850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:18.517800 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:46:18.519364 [debug] [MainThread]: On master: COMMIT
[0m23:46:18.520636 [debug] [MainThread]: Using postgres connection "master"
[0m23:46:18.522033 [debug] [MainThread]: On master: COMMIT
[0m23:46:18.523557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:46:18.524821 [debug] [MainThread]: On master: Close
[0m23:46:18.526074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:18.527089 [debug] [MainThread]: Connection 'model.ethiopian_medical_analytics.stg_telegram_channels' was properly closed.
[0m23:46:18.528550 [info ] [MainThread]: 
[0m23:46:18.530121 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m23:46:18.531942 [debug] [MainThread]: Command end result
[0m23:46:18.626203 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:46:18.631069 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:46:18.640208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m23:46:18.641544 [info ] [MainThread]: 
[0m23:46:18.642821 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:46:18.643955 [info ] [MainThread]: 
[0m23:46:18.645215 [error] [MainThread]: [31mFailure in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)[0m
[0m23:46:18.646468 [error] [MainThread]:   Database Error in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)
  column "_channel" does not exist
  LINE 15:   MD5(_channel) AS channel_key,
                 ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql
[0m23:46:18.647510 [info ] [MainThread]: 
[0m23:46:18.648900 [info ] [MainThread]:   compiled code at target/compiled/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql
[0m23:46:18.650277 [info ] [MainThread]: 
[0m23:46:18.651514 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m23:46:18.653968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4584495, "process_in_blocks": "568", "process_kernel_time": 0.2017, "process_mem_max_rss": "126312", "process_out_blocks": "0", "process_user_time": 2.070087}
[0m23:46:18.655707 [debug] [MainThread]: Command `dbt run` failed at 23:46:18.655541 after 1.46 seconds
[0m23:46:18.656857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764a21b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764b3c1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764db151c0>]}
[0m23:46:18.657814 [debug] [MainThread]: Flushing usage events
[0m23:46:19.785234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:36.539308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20604c1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205f98ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205fc308f0>]}


============================== 23:50:36.545805 | c963271a-72d5-48fa-bec1-85543ac9a568 ==============================
[0m23:50:36.545805 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:50:36.547843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_telegram_messages', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:50:36.843635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c963271a-72d5-48fa-bec1-85543ac9a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206068c620>]}
[0m23:50:36.914036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c963271a-72d5-48fa-bec1-85543ac9a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2060813230>]}
[0m23:50:36.917275 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:50:36.981643 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:50:37.358309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:50:37.359830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:50:37.393554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c963271a-72d5-48fa-bec1-85543ac9a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205ebcdf70>]}
[0m23:50:37.496312 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:50:37.506306 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:50:37.550453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c963271a-72d5-48fa-bec1-85543ac9a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205ef3fcb0>]}
[0m23:50:37.552284 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 433 macros
[0m23:50:37.553863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c963271a-72d5-48fa-bec1-85543ac9a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205e7df080>]}
[0m23:50:37.556677 [info ] [MainThread]: 
[0m23:50:37.558576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:50:37.560156 [info ] [MainThread]: 
[0m23:50:37.562289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:50:37.566248 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m23:50:37.614030 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m23:50:37.616044 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:50:37.617293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:37.641082 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.024 seconds
[0m23:50:37.643992 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m23:50:37.649608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics, now list_telegram_analytics_star_analytics)
[0m23:50:37.656741 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:50:37.658690 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m23:50:37.660138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:37.668589 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:50:37.670426 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:50:37.672000 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m23:50:37.677587 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m23:50:37.680523 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m23:50:37.683055 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m23:50:37.685356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now list_telegram_analytics_star_staging)
[0m23:50:37.688698 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:50:37.690680 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m23:50:37.692397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:37.703567 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m23:50:37.705950 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:50:37.708003 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m23:50:37.712521 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m23:50:37.715281 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m23:50:37.717912 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m23:50:37.723614 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:37.726139 [debug] [MainThread]: On master: BEGIN
[0m23:50:37.727774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:37.738994 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:50:37.741394 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:37.743153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:50:37.749138 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m23:50:37.752353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c963271a-72d5-48fa-bec1-85543ac9a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2061fd1100>]}
[0m23:50:37.754927 [debug] [MainThread]: On master: ROLLBACK
[0m23:50:37.757637 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:37.759928 [debug] [MainThread]: On master: BEGIN
[0m23:50:37.762687 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:50:37.764954 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.767039 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:37.768869 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.771086 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:50:37.772938 [debug] [MainThread]: On master: Close
[0m23:50:37.781293 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:50:37.784003 [info ] [Thread-1 (]: 1 of 1 START sql view model star_staging.stg_telegram_messages ................. [RUN]
[0m23:50:37.786104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now model.ethiopian_medical_analytics.stg_telegram_messages)
[0m23:50:37.788116 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:50:37.796081 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.816625 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:50:37.856156 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.870272 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.872203 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: BEGIN
[0m23:50:37.873714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:37.885573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:50:37.887541 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.889429 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */

  create view "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    

WITH combined_messages AS (
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_chemed123"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_lobelia4cosmetics"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_tikvahpharma"
)

SELECT
  id::INTEGER AS message_id,
  text AS message_text,
  date::TIMESTAMP AS message_date,
  _channel AS channel_name,
  views::INTEGER AS view_count,
  _loaded_at::TIMESTAMP AS loaded_at
FROM combined_messages
  );
[0m23:50:37.900667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:50:37.912193 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.914175 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m23:50:37.917168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:37.923226 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.925176 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m23:50:37.927717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:50:37.953352 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:50:37.955510 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.957127 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:50:37.962574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:50:37.973606 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup"
[0m23:50:37.980672 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:50:37.982545 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
drop view if exists "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup" cascade
[0m23:50:37.994301 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m23:50:37.997847 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: Close
[0m23:50:38.000925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c963271a-72d5-48fa-bec1-85543ac9a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20621ea810>]}
[0m23:50:38.002516 [info ] [Thread-1 (]: 1 of 1 OK created sql view model star_staging.stg_telegram_messages ............ [[32mCREATE VIEW[0m in 0.21s]
[0m23:50:38.003968 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:50:38.006344 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:38.007736 [debug] [MainThread]: On master: BEGIN
[0m23:50:38.008760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:38.018068 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:50:38.019510 [debug] [MainThread]: On master: COMMIT
[0m23:50:38.020632 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:38.021997 [debug] [MainThread]: On master: COMMIT
[0m23:50:38.023597 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:50:38.024809 [debug] [MainThread]: On master: Close
[0m23:50:38.026157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:38.027829 [debug] [MainThread]: Connection 'model.ethiopian_medical_analytics.stg_telegram_messages' was properly closed.
[0m23:50:38.029322 [info ] [MainThread]: 
[0m23:50:38.030502 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m23:50:38.032028 [debug] [MainThread]: Command end result
[0m23:50:38.064350 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:50:38.071097 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:50:38.080418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m23:50:38.081667 [info ] [MainThread]: 
[0m23:50:38.083248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:50:38.084346 [info ] [MainThread]: 
[0m23:50:38.085361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:50:38.088124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.633128, "process_in_blocks": "82792", "process_kernel_time": 0.307072, "process_mem_max_rss": "129036", "process_out_blocks": "0", "process_user_time": 2.006935}
[0m23:50:38.089496 [debug] [MainThread]: Command `dbt run` succeeded at 23:50:38.089365 after 1.63 seconds
[0m23:50:38.090487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20604e4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2063e2b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205e3a02f0>]}
[0m23:50:38.091477 [debug] [MainThread]: Flushing usage events
[0m23:50:39.955623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:52:52.980366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0864760f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff085ff80e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff086f5a1b0>]}


============================== 23:52:52.985048 | 28339e6c-5100-4cda-b2f4-53a855e54bcc ==============================
[0m23:52:52.985048 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:52:52.986584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:52:53.321111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0885b7440>]}
[0m23:52:53.385685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff086a23560>]}
[0m23:52:53.388897 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:52:53.447639 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:52:53.763082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:52:53.764833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:52:53.807197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff084ff9af0>]}
[0m23:52:53.895819 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:52:53.901922 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:52:53.933418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff084748a10>]}
[0m23:52:53.934949 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 433 macros
[0m23:52:53.936403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08640eae0>]}
[0m23:52:53.939754 [info ] [MainThread]: 
[0m23:52:53.941721 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:52:53.943991 [info ] [MainThread]: 
[0m23:52:53.946181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:53.953074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m23:52:53.989928 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m23:52:53.991964 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:52:53.993672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:54.040334 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.047 seconds
[0m23:52:54.043834 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m23:52:54.050977 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m23:52:54.053343 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:52:54.055637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:54.066682 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m23:52:54.069672 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m23:52:54.073235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics, now list_telegram_analytics_star_analytics)
[0m23:52:54.081639 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:52:54.083717 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m23:52:54.085538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:54.096244 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m23:52:54.098047 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:52:54.099608 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m23:52:54.105431 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m23:52:54.107721 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m23:52:54.109590 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m23:52:54.111652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now list_telegram_analytics_star_staging)
[0m23:52:54.115208 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:52:54.116760 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m23:52:54.117724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:54.126766 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:52:54.128429 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:52:54.130027 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m23:52:54.134649 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m23:52:54.137223 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m23:52:54.139301 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m23:52:54.147657 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:54.149633 [debug] [MainThread]: On master: BEGIN
[0m23:52:54.151193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:54.161972 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:52:54.163816 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:54.165357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:54.171842 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m23:52:54.174227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff082e4da90>]}
[0m23:52:54.175882 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:54.177800 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:54.179135 [debug] [MainThread]: On master: BEGIN
[0m23:52:54.180927 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:52:54.182303 [debug] [MainThread]: On master: COMMIT
[0m23:52:54.183478 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:54.184529 [debug] [MainThread]: On master: COMMIT
[0m23:52:54.185932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:52:54.187290 [debug] [MainThread]: On master: Close
[0m23:52:54.192346 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:52:54.193752 [info ] [Thread-1 (]: 1 of 5 START sql view model star_staging.stg_telegram_messages ................. [RUN]
[0m23:52:54.195041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now model.ethiopian_medical_analytics.stg_telegram_messages)
[0m23:52:54.196088 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:52:54.204620 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.219212 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:52:54.254036 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.265802 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.267510 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: BEGIN
[0m23:52:54.269442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:54.278270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:52:54.280316 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.281747 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */

  create view "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    

WITH combined_messages AS (
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_chemed123"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_lobelia4cosmetics"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_tikvahpharma"
)

SELECT
  id::INTEGER AS message_id,
  text AS message_text,
  date::TIMESTAMP AS message_date,
  _channel AS channel_name,
  views::INTEGER AS view_count,
  _loaded_at::TIMESTAMP AS loaded_at
FROM combined_messages
  );
[0m23:52:54.289957 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:52:54.299288 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.300933 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m23:52:54.302798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:54.306697 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.308571 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m23:52:54.310783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:54.325242 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:52:54.329294 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.330823 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:52:54.335912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:52:54.343163 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup"
[0m23:52:54.349063 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:52:54.351001 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
drop view if exists "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup" cascade
[0m23:52:54.357632 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:52:54.361241 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: Close
[0m23:52:54.364913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0885b6570>]}
[0m23:52:54.367223 [info ] [Thread-1 (]: 1 of 5 OK created sql view model star_staging.stg_telegram_messages ............ [[32mCREATE VIEW[0m in 0.17s]
[0m23:52:54.369589 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:52:54.372259 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_dates
[0m23:52:54.374177 [info ] [Thread-1 (]: 2 of 5 START sql table model star_analytics.dim_dates .......................... [RUN]
[0m23:52:54.376420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_messages, now model.ethiopian_medical_analytics.dim_dates)
[0m23:52:54.377974 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_dates
[0m23:52:54.384868 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.398073 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_dates
[0m23:52:54.419815 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.436027 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.437764 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: BEGIN
[0m23:52:54.439234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:54.451230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:52:54.454053 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.456238 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */

  
    

  create  table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH date_spine AS (
  SELECT DISTINCT
    DATE_TRUNC('day', message_date) AS date_key
  FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
)

SELECT
  date_key,
  EXTRACT(YEAR FROM date_key) AS year,
  EXTRACT(QUARTER FROM date_key) AS quarter,
  EXTRACT(MONTH FROM date_key) AS month,
  EXTRACT(DAY FROM date_key) AS day,
  EXTRACT(DOW FROM date_key) AS day_of_week,
  TO_CHAR(date_key, 'Day') AS day_name
FROM date_spine
  );
  
[0m23:52:54.475861 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.018 seconds
[0m23:52:54.483181 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.485347 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
alter table "telegram_analytics"."star_analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m23:52:54.490870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:52:54.494650 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.496608 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
alter table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m23:52:54.498798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:54.501842 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m23:52:54.503533 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.505420 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m23:52:54.510616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:52:54.514542 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."dim_dates__dbt_backup"
[0m23:52:54.519434 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:52:54.521775 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
drop table if exists "telegram_analytics"."star_analytics"."dim_dates__dbt_backup" cascade
[0m23:52:54.530558 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:52:54.533960 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: Close
[0m23:52:54.537279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0815443e0>]}
[0m23:52:54.539920 [info ] [Thread-1 (]: 2 of 5 OK created sql table model star_analytics.dim_dates ..................... [[32mSELECT 10[0m in 0.16s]
[0m23:52:54.542574 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_dates
[0m23:52:54.544564 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:52:54.546481 [info ] [Thread-1 (]: 3 of 5 START sql table model star_staging.stg_telegram_channels ................ [RUN]
[0m23:52:54.548533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_dates, now model.ethiopian_medical_analytics.stg_telegram_channels)
[0m23:52:54.550166 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:52:54.554492 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:52:54.569380 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:52:54.573753 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:52:54.588739 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:52:54.590667 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: BEGIN
[0m23:52:54.592540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:54.601673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:52:54.604224 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:52:54.606403 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */

  
    

  create  table "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  MD5(_channel) AS channel_key,
  _channel AS channel_name,
  MIN(_loaded_at) AS first_scraped_at,
  MAX(_loaded_at) AS last_scraped_at,
  CURRENT_TIMESTAMP AS dbt_loaded_at
FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
GROUP BY 1, 2
  );
  
[0m23:52:54.611436 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "_channel" does not exist
LINE 15:   MD5(_channel) AS channel_key,
               ^

[0m23:52:54.613414 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: ROLLBACK
[0m23:52:54.615692 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: Close
[0m23:52:54.627032 [debug] [Thread-1 (]: Database Error in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)
  column "_channel" does not exist
  LINE 15:   MD5(_channel) AS channel_key,
                 ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql
[0m23:52:54.629309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28339e6c-5100-4cda-b2f4-53a855e54bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08470a390>]}
[0m23:52:54.631234 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model star_staging.stg_telegram_channels ....... [[31mERROR[0m in 0.08s]
[0m23:52:54.632774 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:52:54.634100 [debug] [Thread-4 (]: Marking all children of 'model.ethiopian_medical_analytics.stg_telegram_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)
  column "_channel" does not exist
  LINE 15:   MD5(_channel) AS channel_key,
                 ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql.
[0m23:52:54.636513 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_channels
[0m23:52:54.638344 [info ] [Thread-1 (]: 4 of 5 SKIP relation star_analytics.dim_channels ............................... [[33mSKIP[0m]
[0m23:52:54.640022 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_channels
[0m23:52:54.641926 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.fct_messages
[0m23:52:54.643426 [info ] [Thread-1 (]: 5 of 5 SKIP relation star_analytics.fct_messages ............................... [[33mSKIP[0m]
[0m23:52:54.645406 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.fct_messages
[0m23:52:54.648323 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:54.650374 [debug] [MainThread]: On master: BEGIN
[0m23:52:54.652490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:54.663152 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:52:54.665247 [debug] [MainThread]: On master: COMMIT
[0m23:52:54.667403 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:54.669369 [debug] [MainThread]: On master: COMMIT
[0m23:52:54.671399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:52:54.673499 [debug] [MainThread]: On master: Close
[0m23:52:54.675721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:54.677602 [debug] [MainThread]: Connection 'model.ethiopian_medical_analytics.stg_telegram_channels' was properly closed.
[0m23:52:54.679243 [info ] [MainThread]: 
[0m23:52:54.680722 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m23:52:54.683407 [debug] [MainThread]: Command end result
[0m23:52:54.792878 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:52:54.801999 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:52:54.815060 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m23:52:54.816448 [info ] [MainThread]: 
[0m23:52:54.818358 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:52:54.819899 [info ] [MainThread]: 
[0m23:52:54.821541 [error] [MainThread]: [31mFailure in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)[0m
[0m23:52:54.823073 [error] [MainThread]:   Database Error in model stg_telegram_channels (models/staging/stg_telegram_channels.sql)
  column "_channel" does not exist
  LINE 15:   MD5(_channel) AS channel_key,
                 ^
  compiled code at target/run/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql
[0m23:52:54.825227 [info ] [MainThread]: 
[0m23:52:54.827386 [info ] [MainThread]:   compiled code at target/compiled/ethiopian_medical_analytics/models/staging/stg_telegram_channels.sql
[0m23:52:54.829138 [info ] [MainThread]: 
[0m23:52:54.831089 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m23:52:54.835074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9285482, "process_in_blocks": "91064", "process_kernel_time": 0.218755, "process_mem_max_rss": "127376", "process_out_blocks": "0", "process_user_time": 2.460995}
[0m23:52:54.836601 [debug] [MainThread]: Command `dbt run` failed at 23:52:54.836453 after 1.93 seconds
[0m23:52:54.838104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff086b25190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08a1f72f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff081504650>]}
[0m23:52:54.839379 [debug] [MainThread]: Flushing usage events
[0m23:52:56.508611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:27.037315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435decdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435e9b9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435dd43bc0>]}


============================== 23:56:27.043175 | 36ae827d-d52b-4e7f-b0ef-462791277795 ==============================
[0m23:56:27.043175 [info ] [MainThread]: Running with dbt=1.10.4
[0m23:56:27.044596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:56:27.348201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435d300b90>]}
[0m23:56:27.410183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435dd43d40>]}
[0m23:56:27.413666 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:56:27.470172 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m23:56:27.800880 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:56:27.802561 [debug] [MainThread]: Partial parsing: updated file: ethiopian_medical_analytics://models/staging/stg_telegram_channels.sql
[0m23:56:28.111937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435c396060>]}
[0m23:56:28.202818 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:56:28.214191 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:56:28.259524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435c724530>]}
[0m23:56:28.262054 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 433 macros
[0m23:56:28.264011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435cbe67b0>]}
[0m23:56:28.267013 [info ] [MainThread]: 
[0m23:56:28.269013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:56:28.270748 [info ] [MainThread]: 
[0m23:56:28.272477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:28.279851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m23:56:28.314606 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m23:56:28.316556 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:56:28.317881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:28.349132 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.031 seconds
[0m23:56:28.352175 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m23:56:28.357365 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m23:56:28.359502 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m23:56:28.361994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:28.372391 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m23:56:28.375443 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m23:56:28.378654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics, now list_telegram_analytics_star_staging)
[0m23:56:28.433774 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:56:28.435975 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m23:56:28.437687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:28.448362 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m23:56:28.450476 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m23:56:28.452237 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m23:56:28.462914 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m23:56:28.465664 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m23:56:28.467732 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m23:56:28.469743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now list_telegram_analytics_star_analytics)
[0m23:56:28.472620 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:56:28.474583 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m23:56:28.475983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:56:28.484095 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:56:28.485934 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m23:56:28.488015 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m23:56:28.492125 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m23:56:28.494997 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m23:56:28.497267 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m23:56:28.502879 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:28.505187 [debug] [MainThread]: On master: BEGIN
[0m23:56:28.507227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:28.515682 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:56:28.517856 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:28.519584 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:28.525153 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m23:56:28.527860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4360335040>]}
[0m23:56:28.529584 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:28.532071 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:28.533749 [debug] [MainThread]: On master: BEGIN
[0m23:56:28.535987 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:56:28.537887 [debug] [MainThread]: On master: COMMIT
[0m23:56:28.539789 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:28.541511 [debug] [MainThread]: On master: COMMIT
[0m23:56:28.543545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:28.545418 [debug] [MainThread]: On master: Close
[0m23:56:28.551117 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:56:28.553217 [info ] [Thread-1 (]: 1 of 5 START sql view model star_staging.stg_telegram_messages ................. [RUN]
[0m23:56:28.554992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now model.ethiopian_medical_analytics.stg_telegram_messages)
[0m23:56:28.556420 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:56:28.563402 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.580094 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:56:28.606673 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.624363 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.626146 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: BEGIN
[0m23:56:28.627868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:28.636073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:56:28.638253 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.640385 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */

  create view "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    

WITH combined_messages AS (
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_chemed123"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_lobelia4cosmetics"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_tikvahpharma"
)

SELECT
  id::INTEGER AS message_id,
  text AS message_text,
  date::TIMESTAMP AS message_date,
  _channel AS channel_name,
  views::INTEGER AS view_count,
  _loaded_at::TIMESTAMP AS loaded_at
FROM combined_messages
  );
[0m23:56:28.647929 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:56:28.654106 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.656036 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m23:56:28.658809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:28.662731 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.664630 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m23:56:28.666923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:28.679623 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:56:28.681862 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.683508 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m23:56:28.688677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:56:28.694684 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup"
[0m23:56:28.700117 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m23:56:28.702064 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
drop view if exists "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup" cascade
[0m23:56:28.708688 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:56:28.712082 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: Close
[0m23:56:28.715774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f436054e780>]}
[0m23:56:28.718049 [info ] [Thread-1 (]: 1 of 5 OK created sql view model star_staging.stg_telegram_messages ............ [[32mCREATE VIEW[0m in 0.16s]
[0m23:56:28.720110 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m23:56:28.722869 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_dates
[0m23:56:28.724825 [info ] [Thread-1 (]: 2 of 5 START sql table model star_analytics.dim_dates .......................... [RUN]
[0m23:56:28.726629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_messages, now model.ethiopian_medical_analytics.dim_dates)
[0m23:56:28.728426 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_dates
[0m23:56:28.732780 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.745711 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_dates
[0m23:56:28.766672 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.788891 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.790911 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: BEGIN
[0m23:56:28.792603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:28.801898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:56:28.804194 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.806220 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */

  
    

  create  table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH date_spine AS (
  SELECT DISTINCT
    DATE_TRUNC('day', message_date) AS date_key
  FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
)

SELECT
  date_key,
  EXTRACT(YEAR FROM date_key) AS year,
  EXTRACT(QUARTER FROM date_key) AS quarter,
  EXTRACT(MONTH FROM date_key) AS month,
  EXTRACT(DAY FROM date_key) AS day,
  EXTRACT(DOW FROM date_key) AS day_of_week,
  TO_CHAR(date_key, 'Day') AS day_name
FROM date_spine
  );
  
[0m23:56:28.818974 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m23:56:28.825777 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.827968 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
alter table "telegram_analytics"."star_analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m23:56:28.830621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:28.835641 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.837690 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
alter table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m23:56:28.839907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:28.842527 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m23:56:28.844187 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.845771 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m23:56:28.850858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:56:28.854431 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."dim_dates__dbt_backup"
[0m23:56:28.858826 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m23:56:28.860900 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
drop table if exists "telegram_analytics"."star_analytics"."dim_dates__dbt_backup" cascade
[0m23:56:28.867806 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m23:56:28.870710 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: Close
[0m23:56:28.873382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435c38ffb0>]}
[0m23:56:28.875933 [info ] [Thread-1 (]: 2 of 5 OK created sql table model star_analytics.dim_dates ..................... [[32mSELECT 10[0m in 0.15s]
[0m23:56:28.877964 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_dates
[0m23:56:28.879603 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:56:28.881215 [info ] [Thread-1 (]: 3 of 5 START sql table model star_staging.stg_telegram_channels ................ [RUN]
[0m23:56:28.882990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_dates, now model.ethiopian_medical_analytics.stg_telegram_channels)
[0m23:56:28.884474 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:56:28.887930 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:56:28.902619 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:56:28.906609 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:56:28.923889 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:56:28.925584 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: BEGIN
[0m23:56:28.926960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:28.935920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:56:28.938655 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:56:28.941058 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */

  
    

  create  table "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_tmp"
  
  
    as
  
  (
    

WITH channel_data AS (
  SELECT DISTINCT
    channel_name,  -- Changed from _channel to channel_name
    MIN(loaded_at) AS first_scraped_at,
    MAX(loaded_at) AS last_scraped_at
  FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
  GROUP BY 1
)

SELECT
  MD5(channel_name) AS channel_key,  -- Changed from _channel to channel_name
  channel_name,
  first_scraped_at,
  last_scraped_at,
  CURRENT_TIMESTAMP AS dbt_loaded_at
FROM channel_data
  );
  
[0m23:56:28.962137 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.018 seconds
[0m23:56:28.967025 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:56:28.969132 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_tmp" rename to "stg_telegram_channels"
[0m23:56:28.972182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:28.975662 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: COMMIT
[0m23:56:28.977988 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:56:28.979853 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: COMMIT
[0m23:56:28.985834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:56:28.989399 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_backup"
[0m23:56:28.992053 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m23:56:28.994191 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */
drop table if exists "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_backup" cascade
[0m23:56:28.997572 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:56:29.000859 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: Close
[0m23:56:29.003072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435c7a8680>]}
[0m23:56:29.005660 [info ] [Thread-1 (]: 3 of 5 OK created sql table model star_staging.stg_telegram_channels ........... [[32mSELECT 3[0m in 0.12s]
[0m23:56:29.007968 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m23:56:29.010701 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_channels
[0m23:56:29.013087 [info ] [Thread-1 (]: 4 of 5 START sql table model star_analytics.dim_channels ....................... [RUN]
[0m23:56:29.015003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_channels, now model.ethiopian_medical_analytics.dim_channels)
[0m23:56:29.017329 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_channels
[0m23:56:29.022452 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_channels"
[0m23:56:29.043145 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_channels
[0m23:56:29.048805 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.dim_channels"
[0m23:56:29.060321 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m23:56:29.061892 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: BEGIN
[0m23:56:29.063272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:29.073917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:56:29.075702 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m23:56:29.077194 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_channels"} */

  
    

  create  table "telegram_analytics"."star_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  channel_key,
  channel_name,
  first_scraped_at,
  last_scraped_at,
  CASE
    WHEN channel_name ILIKE '%pharma%' THEN 'Pharmaceutical'
    WHEN channel_name ILIKE '%cosmetic%' THEN 'Cosmetic'
    ELSE 'Other'
  END AS channel_category
FROM "telegram_analytics"."star_staging"."stg_telegram_channels"
  );
  
[0m23:56:29.092426 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.013 seconds
[0m23:56:29.099425 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m23:56:29.101538 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_channels"} */
alter table "telegram_analytics"."star_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m23:56:29.104029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:29.106624 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: COMMIT
[0m23:56:29.108282 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m23:56:29.110379 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: COMMIT
[0m23:56:29.115999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:56:29.119453 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."dim_channels__dbt_backup"
[0m23:56:29.121469 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m23:56:29.123250 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_channels"} */
drop table if exists "telegram_analytics"."star_analytics"."dim_channels__dbt_backup" cascade
[0m23:56:29.125982 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:56:29.129160 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: Close
[0m23:56:29.131703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4359cb9340>]}
[0m23:56:29.134122 [info ] [Thread-1 (]: 4 of 5 OK created sql table model star_analytics.dim_channels .................. [[32mSELECT 3[0m in 0.12s]
[0m23:56:29.136861 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_channels
[0m23:56:29.140010 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.fct_messages
[0m23:56:29.142309 [info ] [Thread-1 (]: 5 of 5 START sql table model star_analytics.fct_messages ....................... [RUN]
[0m23:56:29.144425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_channels, now model.ethiopian_medical_analytics.fct_messages)
[0m23:56:29.147219 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.fct_messages
[0m23:56:29.153038 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.fct_messages"
[0m23:56:29.172892 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.fct_messages
[0m23:56:29.178455 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.fct_messages"
[0m23:56:29.204220 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m23:56:29.206946 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: BEGIN
[0m23:56:29.209643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:56:29.224204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m23:56:29.226835 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m23:56:29.228888 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.fct_messages"} */

  
    

  create  table "telegram_analytics"."star_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  m.message_id,
  c.channel_key,
  d.date_key,
  m.message_text,
  LENGTH(m.message_text) AS message_length,
  m.view_count,
  
  -- Engagement metrics
  CASE 
    WHEN m.view_count > 0 THEN m.view_count::FLOAT / NULLIF(m.view_count, 0)
    ELSE NULL 
  END AS engagement_rate,
  
  -- Ethiopia mentions
  CASE 
    WHEN m.message_text ILIKE '%ethiopia%' THEN TRUE
    ELSE FALSE
  END AS mentions_ethiopia,
  
  m.loaded_at
FROM "telegram_analytics"."star_staging"."stg_telegram_messages" m
LEFT JOIN "telegram_analytics"."star_analytics"."dim_channels" c ON m.channel_name = c.channel_name
LEFT JOIN "telegram_analytics"."star_analytics"."dim_dates" d ON DATE_TRUNC('day', m.message_date) = d.date_key
  );
  
[0m23:56:29.252732 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.021 seconds
[0m23:56:29.261273 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m23:56:29.264559 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.fct_messages"} */
alter table "telegram_analytics"."star_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m23:56:29.268311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:56:29.273108 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: COMMIT
[0m23:56:29.275965 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m23:56:29.278448 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: COMMIT
[0m23:56:29.284286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:56:29.287607 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."fct_messages__dbt_backup"
[0m23:56:29.289943 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m23:56:29.291803 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.fct_messages"} */
drop table if exists "telegram_analytics"."star_analytics"."fct_messages__dbt_backup" cascade
[0m23:56:29.294084 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:56:29.296932 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: Close
[0m23:56:29.299165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36ae827d-d52b-4e7f-b0ef-462791277795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4359caef90>]}
[0m23:56:29.301656 [info ] [Thread-1 (]: 5 of 5 OK created sql table model star_analytics.fct_messages .................. [[32mSELECT 30[0m in 0.15s]
[0m23:56:29.304036 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.fct_messages
[0m23:56:29.307647 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:29.309700 [debug] [MainThread]: On master: BEGIN
[0m23:56:29.311781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:29.322273 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:56:29.324634 [debug] [MainThread]: On master: COMMIT
[0m23:56:29.326931 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:29.328844 [debug] [MainThread]: On master: COMMIT
[0m23:56:29.330876 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:56:29.332674 [debug] [MainThread]: On master: Close
[0m23:56:29.335196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:29.337199 [debug] [MainThread]: Connection 'model.ethiopian_medical_analytics.fct_messages' was properly closed.
[0m23:56:29.339285 [info ] [MainThread]: 
[0m23:56:29.341069 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m23:56:29.344341 [debug] [MainThread]: Command end result
[0m23:56:29.392999 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m23:56:29.401058 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m23:56:29.417587 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m23:56:29.419212 [info ] [MainThread]: 
[0m23:56:29.421090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:29.424478 [info ] [MainThread]: 
[0m23:56:29.426111 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:56:29.429406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4709916, "process_in_blocks": "90584", "process_kernel_time": 0.292129, "process_mem_max_rss": "131660", "process_out_blocks": "0", "process_user_time": 2.499334}
[0m23:56:29.431239 [debug] [MainThread]: Command `dbt run` succeeded at 23:56:29.430939 after 2.47 seconds
[0m23:56:29.432978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435dd855e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435bb3a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f435dc57980>]}
[0m23:56:29.434717 [debug] [MainThread]: Flushing usage events
[0m23:56:30.817488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:01:45.152861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d5a850d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d5968470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6780c20>]}


============================== 00:01:45.159062 | f373f78b-807a-4b1d-ada9-2478bd1bcc7c ==============================
[0m00:01:45.159062 [info ] [MainThread]: Running with dbt=1.10.4
[0m00:01:45.161112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/hp/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m00:01:45.516071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f373f78b-807a-4b1d-ada9-2478bd1bcc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d7523050>]}
[0m00:01:45.584547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f373f78b-807a-4b1d-ada9-2478bd1bcc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d4be7e00>]}
[0m00:01:45.588217 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:01:45.651717 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m00:01:45.983480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:45.984923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:46.017558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f373f78b-807a-4b1d-ada9-2478bd1bcc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d3bb1190>]}
[0m00:01:46.104893 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m00:01:46.117643 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m00:01:46.343430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f373f78b-807a-4b1d-ada9-2478bd1bcc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d5330bf0>]}
[0m00:01:46.349160 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 433 macros
[0m00:01:46.355066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f373f78b-807a-4b1d-ada9-2478bd1bcc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d2fa2c30>]}
[0m00:01:46.368397 [info ] [MainThread]: 
[0m00:01:46.374809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:46.380846 [info ] [MainThread]: 
[0m00:01:46.385636 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:01:46.410850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics_star_analytics'
[0m00:01:46.546337 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m00:01:46.550172 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m00:01:46.553997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:46.594169 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m00:01:46.597272 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m00:01:46.599950 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m00:01:46.624407 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.022 seconds
[0m00:01:46.630581 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m00:01:46.635001 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m00:01:46.639890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now list_telegram_analytics_star_staging)
[0m00:01:46.647557 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m00:01:46.651407 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m00:01:46.655609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:46.672281 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m00:01:46.675864 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m00:01:46.678722 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m00:01:46.686832 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m00:01:46.691167 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m00:01:46.694486 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m00:01:46.705914 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:46.709120 [debug] [MainThread]: On master: BEGIN
[0m00:01:46.711739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:01:46.733992 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m00:01:46.738156 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:46.741720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:01:46.757472 [debug] [MainThread]: SQL status: SELECT 3 in 0.012 seconds
[0m00:01:46.763986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f373f78b-807a-4b1d-ada9-2478bd1bcc7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d7308b60>]}
[0m00:01:46.767847 [debug] [MainThread]: On master: ROLLBACK
[0m00:01:46.771997 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:46.775469 [debug] [MainThread]: On master: BEGIN
[0m00:01:46.779706 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:01:46.782954 [debug] [MainThread]: On master: COMMIT
[0m00:01:46.786430 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:46.789202 [debug] [MainThread]: On master: COMMIT
[0m00:01:46.792213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:01:46.795620 [debug] [MainThread]: On master: Close
[0m00:01:46.806440 [debug] [Thread-1 (]: Began running node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m00:01:46.810099 [info ] [Thread-1 (]: 1 of 1 START test validate_non_empty_messages .................................. [RUN]
[0m00:01:46.813898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now test.ethiopian_medical_analytics.validate_non_empty_messages)
[0m00:01:46.817608 [debug] [Thread-1 (]: Began compiling node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m00:01:46.832235 [debug] [Thread-1 (]: Writing injected SQL for node "test.ethiopian_medical_analytics.validate_non_empty_messages"
[0m00:01:46.854539 [debug] [Thread-1 (]: Began executing node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m00:01:46.884567 [debug] [Thread-1 (]: Writing runtime sql for node "test.ethiopian_medical_analytics.validate_non_empty_messages"
[0m00:01:46.921910 [debug] [Thread-1 (]: Using postgres connection "test.ethiopian_medical_analytics.validate_non_empty_messages"
[0m00:01:46.924392 [debug] [Thread-1 (]: On test.ethiopian_medical_analytics.validate_non_empty_messages: BEGIN
[0m00:01:46.927020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:46.943749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m00:01:46.946523 [debug] [Thread-1 (]: Using postgres connection "test.ethiopian_medical_analytics.validate_non_empty_messages"
[0m00:01:46.949236 [debug] [Thread-1 (]: On test.ethiopian_medical_analytics.validate_non_empty_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "test.ethiopian_medical_analytics.validate_non_empty_messages"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT message_id
FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
WHERE 
  message_text IS NULL 
  OR TRIM(message_text) = ''
  
  
      
    ) dbt_internal_test
[0m00:01:46.962502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m00:01:46.973155 [debug] [Thread-1 (]: On test.ethiopian_medical_analytics.validate_non_empty_messages: ROLLBACK
[0m00:01:46.977307 [debug] [Thread-1 (]: On test.ethiopian_medical_analytics.validate_non_empty_messages: Close
[0m00:01:46.981080 [error] [Thread-1 (]: 1 of 1 FAIL 3 validate_non_empty_messages ...................................... [[31mFAIL 3[0m in 0.17s]
[0m00:01:46.984464 [debug] [Thread-1 (]: Finished running node test.ethiopian_medical_analytics.validate_non_empty_messages
[0m00:01:46.989449 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:46.993008 [debug] [MainThread]: On master: BEGIN
[0m00:01:46.995799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:01:47.015218 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m00:01:47.018481 [debug] [MainThread]: On master: COMMIT
[0m00:01:47.020877 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:47.023047 [debug] [MainThread]: On master: COMMIT
[0m00:01:47.025946 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:01:47.028578 [debug] [MainThread]: On master: Close
[0m00:01:47.031958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:47.034698 [debug] [MainThread]: Connection 'test.ethiopian_medical_analytics.validate_non_empty_messages' was properly closed.
[0m00:01:47.037565 [info ] [MainThread]: 
[0m00:01:47.040324 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m00:01:47.043692 [debug] [MainThread]: Command end result
[0m00:01:47.122087 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m00:01:47.131615 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m00:01:47.162557 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m00:01:47.166289 [info ] [MainThread]: 
[0m00:01:47.168915 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:01:47.171528 [info ] [MainThread]: 
[0m00:01:47.174988 [error] [MainThread]: [31mFailure in test validate_non_empty_messages (tests/validate_non_empty_messages.sql)[0m
[0m00:01:47.177388 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m00:01:47.180494 [info ] [MainThread]: 
[0m00:01:47.183777 [info ] [MainThread]:   compiled code at target/compiled/ethiopian_medical_analytics/tests/validate_non_empty_messages.sql
[0m00:01:47.186500 [info ] [MainThread]: 
[0m00:01:47.189520 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:01:47.194138 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.1156147, "process_in_blocks": "90672", "process_kernel_time": 0.276462, "process_mem_max_rss": "127460", "process_out_blocks": "0", "process_user_time": 2.180983}
[0m00:01:47.197390 [debug] [MainThread]: Command `dbt test` failed at 00:01:47.197146 after 2.12 seconds
[0m00:01:47.199317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d6eba810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d58f7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29d58f7500>]}
[0m00:01:47.201210 [debug] [MainThread]: Flushing usage events
[0m00:01:48.528522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:08:39.851854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f2d86540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f07f7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f0326a20>]}


============================== 00:08:39.873212 | d0c43237-0ac6-489d-94da-e7744a801c20 ==============================
[0m00:08:39.873212 [info ] [MainThread]: Running with dbt=1.10.4
[0m00:08:39.878405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/hp/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:41.045986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f00cdd00>]}
[0m00:08:41.706430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f0e2cad0>]}
[0m00:08:41.734131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:08:42.194639 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m00:08:43.028939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:43.033721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:43.113185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ef3b2030>]}
[0m00:08:43.310908 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m00:08:43.332647 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m00:08:43.411744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10eeb00860>]}
[0m00:08:43.417056 [info ] [MainThread]: Found 5 models, 1 test, 3 sources, 433 macros
[0m00:08:43.420496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10eefc3c50>]}
[0m00:08:43.427992 [info ] [MainThread]: 
[0m00:08:43.437246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:43.441781 [info ] [MainThread]: 
[0m00:08:43.458257 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:08:43.488674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_analytics'
[0m00:08:43.610282 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m00:08:43.613151 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:08:43.616232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:43.727921 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.112 seconds
[0m00:08:43.734269 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m00:08:43.748821 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics"
[0m00:08:43.752594 [debug] [ThreadPool]: On list_telegram_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics"} */

    select distinct nspname from pg_namespace
  
[0m00:08:43.756108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:43.783243 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m00:08:43.788173 [debug] [ThreadPool]: On list_telegram_analytics: Close
[0m00:08:43.794694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics, now list_telegram_analytics_star_analytics)
[0m00:08:43.821386 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m00:08:43.825892 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: BEGIN
[0m00:08:43.829262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:43.856304 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m00:08:43.859899 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_analytics"
[0m00:08:43.863777 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_analytics"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_analytics'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_analytics'
  
[0m00:08:43.893223 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.025 seconds
[0m00:08:43.899277 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: ROLLBACK
[0m00:08:43.903624 [debug] [ThreadPool]: On list_telegram_analytics_star_analytics: Close
[0m00:08:43.909399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_analytics, now list_telegram_analytics_star_staging)
[0m00:08:43.918141 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m00:08:43.921385 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: BEGIN
[0m00:08:43.923875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:43.942007 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m00:08:43.945926 [debug] [ThreadPool]: Using postgres connection "list_telegram_analytics_star_staging"
[0m00:08:43.949436 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "list_telegram_analytics_star_staging"} */
select
      'telegram_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'star_staging'
    union all
    select
      'telegram_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'star_staging'
  
[0m00:08:43.957397 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m00:08:43.962620 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: ROLLBACK
[0m00:08:43.966812 [debug] [ThreadPool]: On list_telegram_analytics_star_staging: Close
[0m00:08:43.980976 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:43.986767 [debug] [MainThread]: On master: BEGIN
[0m00:08:43.989902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:08:44.016131 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m00:08:44.019208 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:44.021829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:08:44.048317 [debug] [MainThread]: SQL status: SELECT 3 in 0.020 seconds
[0m00:08:44.058576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10edfe5040>]}
[0m00:08:44.062442 [debug] [MainThread]: On master: ROLLBACK
[0m00:08:44.066013 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:44.068795 [debug] [MainThread]: On master: BEGIN
[0m00:08:44.073038 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:08:44.076533 [debug] [MainThread]: On master: COMMIT
[0m00:08:44.079515 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:44.082919 [debug] [MainThread]: On master: COMMIT
[0m00:08:44.087338 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:08:44.090916 [debug] [MainThread]: On master: Close
[0m00:08:44.111118 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m00:08:44.117132 [info ] [Thread-1 (]: 1 of 5 START sql view model star_staging.stg_telegram_messages ................. [RUN]
[0m00:08:44.123312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_analytics_star_staging, now model.ethiopian_medical_analytics.stg_telegram_messages)
[0m00:08:44.128271 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_messages
[0m00:08:44.158553 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.303671 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_messages
[0m00:08:44.434161 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.463214 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.466770 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: BEGIN
[0m00:08:44.470265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:44.512095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m00:08:44.515679 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.519718 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */

  create view "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    

WITH combined_messages AS (
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_chemed123"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_lobelia4cosmetics"
  
  UNION ALL
  
  SELECT id, text, date, views, _channel, _loaded_at
  FROM "telegram_analytics"."raw"."telegram_messages_tikvahpharma"
)

SELECT
  id::INTEGER AS message_id,
  text AS message_text,
  date::TIMESTAMP AS message_date,
  _channel AS channel_name,
  views::INTEGER AS view_count,
  _loaded_at::TIMESTAMP AS loaded_at
FROM combined_messages
  );
[0m00:08:44.565268 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m00:08:44.579734 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.583308 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m00:08:44.589906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:08:44.598262 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.601297 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m00:08:44.605953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:08:44.641692 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m00:08:44.645003 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.648685 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: COMMIT
[0m00:08:44.661402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m00:08:44.684033 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup"
[0m00:08:44.694944 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_messages"
[0m00:08:44.699061 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_messages"} */
drop view if exists "telegram_analytics"."star_staging"."stg_telegram_messages__dbt_backup" cascade
[0m00:08:44.716286 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m00:08:44.724945 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_messages: Close
[0m00:08:44.733870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f2a367e0>]}
[0m00:08:44.739908 [info ] [Thread-1 (]: 1 of 5 OK created sql view model star_staging.stg_telegram_messages ............ [[32mCREATE VIEW[0m in 0.61s]
[0m00:08:44.745037 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_messages
[0m00:08:44.750850 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_dates
[0m00:08:44.756041 [info ] [Thread-1 (]: 2 of 5 START sql table model star_analytics.dim_dates .......................... [RUN]
[0m00:08:44.761419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_messages, now model.ethiopian_medical_analytics.dim_dates)
[0m00:08:44.765270 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_dates
[0m00:08:44.782197 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:44.821364 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_dates
[0m00:08:44.877440 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:44.907182 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:44.910541 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: BEGIN
[0m00:08:44.913462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:44.935529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m00:08:44.938914 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:44.942353 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */

  
    

  create  table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    

WITH date_spine AS (
  SELECT DISTINCT
    DATE_TRUNC('day', message_date) AS date_key
  FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
)

SELECT
  date_key,
  EXTRACT(YEAR FROM date_key) AS year,
  EXTRACT(QUARTER FROM date_key) AS quarter,
  EXTRACT(MONTH FROM date_key) AS month,
  EXTRACT(DAY FROM date_key) AS day,
  EXTRACT(DOW FROM date_key) AS day_of_week,
  TO_CHAR(date_key, 'Day') AS day_name
FROM date_spine
  );
  
[0m00:08:44.997098 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.051 seconds
[0m00:08:45.020347 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:45.024583 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
alter table "telegram_analytics"."star_analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m00:08:45.031207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:08:45.042569 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:45.046262 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
alter table "telegram_analytics"."star_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m00:08:45.051770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:08:45.057493 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m00:08:45.060312 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:45.063407 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: COMMIT
[0m00:08:45.072844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:08:45.080625 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."dim_dates__dbt_backup"
[0m00:08:45.089454 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_dates"
[0m00:08:45.092598 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_dates"} */
drop table if exists "telegram_analytics"."star_analytics"."dim_dates__dbt_backup" cascade
[0m00:08:45.117673 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m00:08:45.123829 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_dates: Close
[0m00:08:45.128158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ed2b47d0>]}
[0m00:08:45.132730 [info ] [Thread-1 (]: 2 of 5 OK created sql table model star_analytics.dim_dates ..................... [[32mSELECT 10[0m in 0.37s]
[0m00:08:45.137805 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_dates
[0m00:08:45.142516 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m00:08:45.146463 [info ] [Thread-1 (]: 3 of 5 START sql table model star_staging.stg_telegram_channels ................ [RUN]
[0m00:08:45.151390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_dates, now model.ethiopian_medical_analytics.stg_telegram_channels)
[0m00:08:45.155477 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.stg_telegram_channels
[0m00:08:45.170613 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.208516 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.stg_telegram_channels
[0m00:08:45.223745 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.252696 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.256131 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: BEGIN
[0m00:08:45.259831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:45.286688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m00:08:45.290786 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.293562 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */

  
    

  create  table "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_tmp"
  
  
    as
  
  (
    

WITH channel_data AS (
  SELECT DISTINCT
    channel_name,  -- Changed from _channel to channel_name
    MIN(loaded_at) AS first_scraped_at,
    MAX(loaded_at) AS last_scraped_at
  FROM "telegram_analytics"."star_staging"."stg_telegram_messages"
  GROUP BY 1
)

SELECT
  MD5(channel_name) AS channel_key,  -- Changed from _channel to channel_name
  channel_name,
  first_scraped_at,
  last_scraped_at,
  CURRENT_TIMESTAMP AS dbt_loaded_at
FROM channel_data
  );
  
[0m00:08:45.316993 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.021 seconds
[0m00:08:45.326604 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.329820 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_channels" rename to "stg_telegram_channels__dbt_backup"
[0m00:08:45.335601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:08:45.341928 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.344739 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */
alter table "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_tmp" rename to "stg_telegram_channels"
[0m00:08:45.348976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:08:45.355055 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: COMMIT
[0m00:08:45.359281 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.362865 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: COMMIT
[0m00:08:45.371708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m00:08:45.377799 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_backup"
[0m00:08:45.380904 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.stg_telegram_channels"
[0m00:08:45.384571 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.stg_telegram_channels"} */
drop table if exists "telegram_analytics"."star_staging"."stg_telegram_channels__dbt_backup" cascade
[0m00:08:45.394753 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:08:45.400310 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.stg_telegram_channels: Close
[0m00:08:45.404231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ed2f1250>]}
[0m00:08:45.408076 [info ] [Thread-1 (]: 3 of 5 OK created sql table model star_staging.stg_telegram_channels ........... [[32mSELECT 3[0m in 0.25s]
[0m00:08:45.411681 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.stg_telegram_channels
[0m00:08:45.416066 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.dim_channels
[0m00:08:45.419261 [info ] [Thread-1 (]: 4 of 5 START sql table model star_analytics.dim_channels ....................... [RUN]
[0m00:08:45.422715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.stg_telegram_channels, now model.ethiopian_medical_analytics.dim_channels)
[0m00:08:45.425998 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.dim_channels
[0m00:08:45.437525 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.465229 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.dim_channels
[0m00:08:45.476936 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.503964 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.509439 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: BEGIN
[0m00:08:45.512102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:45.535541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m00:08:45.539569 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.543082 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_channels"} */

  
    

  create  table "telegram_analytics"."star_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  channel_key,
  channel_name,
  first_scraped_at,
  last_scraped_at,
  CASE
    WHEN channel_name ILIKE '%pharma%' THEN 'Pharmaceutical'
    WHEN channel_name ILIKE '%cosmetic%' THEN 'Cosmetic'
    ELSE 'Other'
  END AS channel_category
FROM "telegram_analytics"."star_staging"."stg_telegram_channels"
  );
  
[0m00:08:45.573065 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.027 seconds
[0m00:08:45.722287 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.729138 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_channels"} */
alter table "telegram_analytics"."star_analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m00:08:45.734364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:08:45.748257 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.753307 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_channels"} */
alter table "telegram_analytics"."star_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m00:08:45.758070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:08:45.764429 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: COMMIT
[0m00:08:45.767235 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.774214 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: COMMIT
[0m00:08:45.782139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:08:45.792148 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."dim_channels__dbt_backup"
[0m00:08:45.796726 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.dim_channels"
[0m00:08:45.799458 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.dim_channels"} */
drop table if exists "telegram_analytics"."star_analytics"."dim_channels__dbt_backup" cascade
[0m00:08:45.810944 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m00:08:45.816187 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.dim_channels: Close
[0m00:08:45.820401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ec15d280>]}
[0m00:08:45.825153 [info ] [Thread-1 (]: 4 of 5 OK created sql table model star_analytics.dim_channels .................. [[32mSELECT 3[0m in 0.40s]
[0m00:08:45.828669 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.dim_channels
[0m00:08:45.835882 [debug] [Thread-1 (]: Began running node model.ethiopian_medical_analytics.fct_messages
[0m00:08:45.839276 [info ] [Thread-1 (]: 5 of 5 START sql table model star_analytics.fct_messages ....................... [RUN]
[0m00:08:45.842838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ethiopian_medical_analytics.dim_channels, now model.ethiopian_medical_analytics.fct_messages)
[0m00:08:45.845779 [debug] [Thread-1 (]: Began compiling node model.ethiopian_medical_analytics.fct_messages
[0m00:08:45.859689 [debug] [Thread-1 (]: Writing injected SQL for node "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:45.888091 [debug] [Thread-1 (]: Began executing node model.ethiopian_medical_analytics.fct_messages
[0m00:08:45.897126 [debug] [Thread-1 (]: Writing runtime sql for node "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:45.924957 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:45.928537 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: BEGIN
[0m00:08:45.933036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:45.952637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m00:08:45.955603 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:45.958561 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.fct_messages"} */

  
    

  create  table "telegram_analytics"."star_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  m.message_id,
  c.channel_key,
  d.date_key,
  m.message_text,
  LENGTH(m.message_text) AS message_length,
  m.view_count,
  
  -- Engagement metrics
  CASE 
    WHEN m.view_count > 0 THEN m.view_count::FLOAT / NULLIF(m.view_count, 0)
    ELSE NULL 
  END AS engagement_rate,
  
  -- Ethiopia mentions
  CASE 
    WHEN m.message_text ILIKE '%ethiopia%' THEN TRUE
    ELSE FALSE
  END AS mentions_ethiopia,
  
  m.loaded_at
FROM "telegram_analytics"."star_staging"."stg_telegram_messages" m
LEFT JOIN "telegram_analytics"."star_analytics"."dim_channels" c ON m.channel_name = c.channel_name
LEFT JOIN "telegram_analytics"."star_analytics"."dim_dates" d ON DATE_TRUNC('day', m.message_date) = d.date_key
  );
  
[0m00:08:45.982817 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.021 seconds
[0m00:08:45.992516 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:45.995834 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.fct_messages"} */
alter table "telegram_analytics"."star_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m00:08:46.007774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m00:08:46.017016 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:46.020783 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.fct_messages"} */
alter table "telegram_analytics"."star_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m00:08:46.024608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:08:46.031611 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: COMMIT
[0m00:08:46.035543 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:46.038882 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: COMMIT
[0m00:08:46.046321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m00:08:46.054033 [debug] [Thread-1 (]: Applying DROP to: "telegram_analytics"."star_analytics"."fct_messages__dbt_backup"
[0m00:08:46.057463 [debug] [Thread-1 (]: Using postgres connection "model.ethiopian_medical_analytics.fct_messages"
[0m00:08:46.060267 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "ethiopian_medical_analytics", "target_name": "dev", "node_id": "model.ethiopian_medical_analytics.fct_messages"} */
drop table if exists "telegram_analytics"."star_analytics"."fct_messages__dbt_backup" cascade
[0m00:08:46.070324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m00:08:46.076096 [debug] [Thread-1 (]: On model.ethiopian_medical_analytics.fct_messages: Close
[0m00:08:46.080271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c43237-0ac6-489d-94da-e7744a801c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10ec151070>]}
[0m00:08:46.087389 [info ] [Thread-1 (]: 5 of 5 OK created sql table model star_analytics.fct_messages .................. [[32mSELECT 30[0m in 0.24s]
[0m00:08:46.092074 [debug] [Thread-1 (]: Finished running node model.ethiopian_medical_analytics.fct_messages
[0m00:08:46.098405 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:46.103335 [debug] [MainThread]: On master: BEGIN
[0m00:08:46.106378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:08:46.147964 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m00:08:46.151832 [debug] [MainThread]: On master: COMMIT
[0m00:08:46.155835 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:46.162865 [debug] [MainThread]: On master: COMMIT
[0m00:08:46.168028 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:08:46.171757 [debug] [MainThread]: On master: Close
[0m00:08:46.175916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:46.179564 [debug] [MainThread]: Connection 'model.ethiopian_medical_analytics.fct_messages' was properly closed.
[0m00:08:46.183161 [info ] [MainThread]: 
[0m00:08:46.186758 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m00:08:46.193486 [debug] [MainThread]: Command end result
[0m00:08:46.351709 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/manifest.json
[0m00:08:46.369417 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/semantic_manifest.json
[0m00:08:46.399589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/hp/Desktop/10 Academy/Ass/Week7/TelegramScraper/dbt/target/run_results.json
[0m00:08:46.402716 [info ] [MainThread]: 
[0m00:08:46.405789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:46.410134 [info ] [MainThread]: 
[0m00:08:46.414244 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m00:08:46.422863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9761634, "process_in_blocks": "89040", "process_kernel_time": 3.452312, "process_mem_max_rss": "129396", "process_out_blocks": "0", "process_user_time": 8.973992}
[0m00:08:46.428119 [debug] [MainThread]: Command `dbt run` succeeded at 00:08:46.427643 after 6.98 seconds
[0m00:08:46.431760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f01567e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10effa8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10f01d94c0>]}
[0m00:08:46.436941 [debug] [MainThread]: Flushing usage events
[0m00:08:52.414292 [debug] [MainThread]: An error was encountered while trying to flush usage events
